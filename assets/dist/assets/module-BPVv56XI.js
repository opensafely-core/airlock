var Ht=Object.defineProperty;var It=(i,e,t)=>e in i?Ht(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var M=(i,e,t)=>(It(i,typeof e!="symbol"?e+"":e,t),t);const et=i=>Object.prototype.toString.call(i)==="[object Object]",Yt=i=>{let e=!1;try{e=JSON.parse(i)}catch{return!1}return!(e===null||!Array.isArray(e)&&!et(e))&&e},U=(i,e)=>{const t=document.createElement(i);if(e&&typeof e=="object")for(const s in e)s==="html"?t.innerHTML=e[s]:t.setAttribute(s,e[s]);return t},ht=i=>["#text","#comment"].includes(i.nodeName)?i.data:i.childNodes?i.childNodes.map(e=>ht(e)).join(""):"",z=i=>{if(i==null)return"";if(i.hasOwnProperty("text")||i.hasOwnProperty("data")){const e=i;return e.text??z(e.data)}return i.hasOwnProperty("nodeName")?ht(i):String(i)},rt=function(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},pt=function(i,e){let t=0,s=0;for(;t<i+1;)e[s].hidden||(t+=1),s+=1;return s-1},$t=function(i){const e={};if(i)for(const t of i)e[t.name]=t.value;return e},B=i=>i?i.trim().split(" ").map(e=>`.${e}`).join(""):null,wt=(i,e)=>!(e==null?void 0:e.split(" ").some(s=>!i.classList.contains(s))),X=(i,e)=>i?e?`${i} ${e}`:i:e||"";var Mt=function(){return Mt=Object.assign||function(i){for(var e,t=arguments,s=1,n=arguments.length;s<n;s++)for(var a in e=t[s])Object.prototype.hasOwnProperty.call(e,a)&&(i[a]=e[a]);return i},Mt.apply(this,arguments)};function mt(i,e,t){if(t||arguments.length===2)for(var s,n=0,a=e.length;n<a;n++)!s&&n in e||(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return i.concat(s||Array.prototype.slice.call(e))}var P=function(){function i(e){e===void 0&&(e={});var t=this;Object.entries(e).forEach(function(s){var n=s[0],a=s[1];return t[n]=a})}return i.prototype.toString=function(){return JSON.stringify(this)},i.prototype.setValue=function(e,t){return this[e]=t,this},i}();function I(i){for(var e=arguments,t=[],s=1;s<arguments.length;s++)t[s-1]=e[s];return i!=null&&t.some(function(n){var a,r;return typeof((r=(a=i==null?void 0:i.ownerDocument)===null||a===void 0?void 0:a.defaultView)===null||r===void 0?void 0:r[n])=="function"&&i instanceof i.ownerDocument.defaultView[n]})}function Nt(i,e,t){var s;return i.nodeName==="#text"?s=t.document.createTextNode(i.data):i.nodeName==="#comment"?s=t.document.createComment(i.data):(e?(s=t.document.createElementNS("http://www.w3.org/2000/svg",i.nodeName),i.nodeName==="foreignObject"&&(e=!1)):i.nodeName.toLowerCase()==="svg"?(s=t.document.createElementNS("http://www.w3.org/2000/svg","svg"),e=!0):s=t.document.createElement(i.nodeName),i.attributes&&Object.entries(i.attributes).forEach(function(n){var a=n[0],r=n[1];return s.setAttribute(a,r)}),i.childNodes&&i.childNodes.forEach(function(n){return s.appendChild(Nt(n,e,t))}),t.valueDiffing&&(i.value&&I(s,"HTMLButtonElement","HTMLDataElement","HTMLInputElement","HTMLLIElement","HTMLMeterElement","HTMLOptionElement","HTMLProgressElement","HTMLParamElement")&&(s.value=i.value),i.checked&&I(s,"HTMLInputElement")&&(s.checked=i.checked),i.selected&&I(s,"HTMLOptionElement")&&(s.selected=i.selected))),s}var _t=function(i,e){for(e=e.slice();e.length>0;){var t=e.splice(0,1)[0];i=i.childNodes[t]}return i};function G(i,e,t){var s,n,a,r=e[t._const.action],o=e[t._const.route];[t._const.addElement,t._const.addTextElement].includes(r)||(s=_t(i,o));var l={diff:e,node:s};if(t.preDiffApply(l))return!0;switch(r){case t._const.addAttribute:if(!s||!I(s,"Element"))return!1;s.setAttribute(e[t._const.name],e[t._const.value]);break;case t._const.modifyAttribute:if(!s||!I(s,"Element"))return!1;s.setAttribute(e[t._const.name],e[t._const.newValue]),I(s,"HTMLInputElement")&&e[t._const.name]==="value"&&(s.value=e[t._const.newValue]);break;case t._const.removeAttribute:if(!s||!I(s,"Element"))return!1;s.removeAttribute(e[t._const.name]);break;case t._const.modifyTextElement:if(!s||!I(s,"Text"))return!1;t.textDiff(s,s.data,e[t._const.oldValue],e[t._const.newValue]),I(s.parentNode,"HTMLTextAreaElement")&&(s.parentNode.value=e[t._const.newValue]);break;case t._const.modifyValue:if(!s||s.value===void 0)return!1;s.value=e[t._const.newValue];break;case t._const.modifyComment:if(!s||!I(s,"Comment"))return!1;t.textDiff(s,s.data,e[t._const.oldValue],e[t._const.newValue]);break;case t._const.modifyChecked:if(!s||s.checked===void 0)return!1;s.checked=e[t._const.newValue];break;case t._const.modifySelected:if(!s||s.selected===void 0)return!1;s.selected=e[t._const.newValue];break;case t._const.replaceElement:var d=e[t._const.newValue].nodeName.toLowerCase()==="svg"||s.parentNode.namespaceURI==="http://www.w3.org/2000/svg";s.parentNode.replaceChild(Nt(e[t._const.newValue],d,t),s);break;case t._const.relocateGroup:mt([],new Array(e[t._const.groupLength]),!0).map(function(){return s.removeChild(s.childNodes[e[t._const.from]])}).forEach(function(m,p){p===0&&(a=s.childNodes[e[t._const.to]]),s.insertBefore(m,a||null)});break;case t._const.removeElement:s.parentNode.removeChild(s);break;case t._const.addElement:var u=(h=o.slice()).splice(h.length-1,1)[0];if(!I(s=_t(i,h),"Element"))return!1;s.insertBefore(Nt(e[t._const.element],s.namespaceURI==="http://www.w3.org/2000/svg",t),s.childNodes[u]||null);break;case t._const.removeTextElement:if(!s||s.nodeType!==3)return!1;var f=s.parentNode;f.removeChild(s),I(f,"HTMLTextAreaElement")&&(f.value="");break;case t._const.addTextElement:var h;if(u=(h=o.slice()).splice(h.length-1,1)[0],n=t.document.createTextNode(e[t._const.value]),!(s=_t(i,h)).childNodes)return!1;s.insertBefore(n,s.childNodes[u]||null),I(s.parentNode,"HTMLTextAreaElement")&&(s.parentNode.value=e[t._const.value]);break;default:console.log("unknown action")}return t.postDiffApply({diff:l.diff,node:l.node,newNode:n}),!0}function yt(i,e,t){var s=i[e];i[e]=i[t],i[t]=s}function jt(i,e,t){(e=e.slice()).reverse(),e.forEach(function(s){(function(n,a,r){switch(a[r._const.action]){case r._const.addAttribute:a[r._const.action]=r._const.removeAttribute,G(n,a,r);break;case r._const.modifyAttribute:yt(a,r._const.oldValue,r._const.newValue),G(n,a,r);break;case r._const.removeAttribute:a[r._const.action]=r._const.addAttribute,G(n,a,r);break;case r._const.modifyTextElement:case r._const.modifyValue:case r._const.modifyComment:case r._const.modifyChecked:case r._const.modifySelected:case r._const.replaceElement:yt(a,r._const.oldValue,r._const.newValue),G(n,a,r);break;case r._const.relocateGroup:yt(a,r._const.from,r._const.to),G(n,a,r);break;case r._const.removeElement:a[r._const.action]=r._const.addElement,G(n,a,r);break;case r._const.addElement:a[r._const.action]=r._const.removeElement,G(n,a,r);break;case r._const.removeTextElement:a[r._const.action]=r._const.addTextElement,G(n,a,r);break;case r._const.addTextElement:a[r._const.action]=r._const.removeTextElement,G(n,a,r);break;default:console.log("unknown action")}})(i,s,t)})}var Ot=function(i){var e=[];return e.push(i.nodeName),i.nodeName!=="#text"&&i.nodeName!=="#comment"&&i.attributes&&(i.attributes.class&&e.push("".concat(i.nodeName,".").concat(i.attributes.class.replace(/ /g,"."))),i.attributes.id&&e.push("".concat(i.nodeName,"#").concat(i.attributes.id))),e},Ct=function(i){var e={},t={};return i.forEach(function(s){Ot(s).forEach(function(n){var a=n in e;a||n in t?a&&(delete e[n],t[n]=!0):e[n]=!0})}),e},Lt=function(i,e){var t=Ct(i),s=Ct(e),n={};return Object.keys(t).forEach(function(a){s[a]&&(n[a]=!0)}),n},Pt=function(i){return delete i.outerDone,delete i.innerDone,delete i.valueDone,!i.childNodes||i.childNodes.every(Pt)},j=function(i){if(Object.prototype.hasOwnProperty.call(i,"data"))return{nodeName:i.nodeName==="#text"?"#text":"#comment",data:i.data};var e={nodeName:i.nodeName};return Object.prototype.hasOwnProperty.call(i,"attributes")&&(e.attributes=Mt({},i.attributes)),Object.prototype.hasOwnProperty.call(i,"checked")&&(e.checked=i.checked),Object.prototype.hasOwnProperty.call(i,"value")&&(e.value=i.value),Object.prototype.hasOwnProperty.call(i,"selected")&&(e.selected=i.selected),Object.prototype.hasOwnProperty.call(i,"childNodes")&&(e.childNodes=i.childNodes.map(function(t){return j(t)})),e},xt=function(i,e){if(!["nodeName","value","checked","selected","data"].every(function(n){return i[n]===e[n]}))return!1;if(Object.prototype.hasOwnProperty.call(i,"data"))return!0;if(!!i.attributes!=!!e.attributes||!!i.childNodes!=!!e.childNodes)return!1;if(i.attributes){var t=Object.keys(i.attributes),s=Object.keys(e.attributes);if(t.length!==s.length||!t.every(function(n){return i.attributes[n]===e.attributes[n]}))return!1}return!(i.childNodes&&(i.childNodes.length!==e.childNodes.length||!i.childNodes.every(function(n,a){return xt(n,e.childNodes[a])})))},Vt=function(i,e,t,s,n){if(n===void 0&&(n=!1),!i||!e||i.nodeName!==e.nodeName)return!1;if(["#text","#comment"].includes(i.nodeName))return!!n||i.data===e.data;if(i.nodeName in t)return!0;if(i.attributes&&e.attributes){if(i.attributes.id){if(i.attributes.id!==e.attributes.id)return!1;if("".concat(i.nodeName,"#").concat(i.attributes.id)in t)return!0}if(i.attributes.class&&i.attributes.class===e.attributes.class&&"".concat(i.nodeName,".").concat(i.attributes.class.replace(/ /g,"."))in t)return!0}if(s)return!0;var a=i.childNodes?i.childNodes.slice().reverse():[],r=e.childNodes?e.childNodes.slice().reverse():[];if(a.length!==r.length)return!1;if(n)return a.every(function(l,d){return l.nodeName===r[d].nodeName});var o=Lt(a,r);return a.every(function(l,d){return Vt(l,r[d],o,!0,!0)})},ft=function(i,e){return mt([],new Array(i),!0).map(function(){return e})},Ft=function(i,e){for(var t=i.childNodes?i.childNodes:[],s=e.childNodes?e.childNodes:[],n=ft(t.length,!1),a=ft(s.length,!1),r=[],o=function(){return arguments[1]},l=!1,d=function(){var u=function(f,h,m,p){var y=0,N=[],E=f.length,c=h.length,w=mt([],new Array(E+1),!0).map(function(){return[]}),k=Lt(f,h),S=E===c;S&&f.some(function(T,R){var _=Ot(T),b=Ot(h[R]);return _.length!==b.length?(S=!1,!0):(_.some(function(g,D){if(g!==b[D])return S=!1,!0}),!S||void 0)});for(var C=0;C<E;C++)for(var L=f[C],V=0;V<c;V++){var O=h[V];m[C]||p[V]||!Vt(L,O,k,S)?w[C+1][V+1]=0:(w[C+1][V+1]=w[C][V]?w[C][V]+1:1,w[C+1][V+1]>=y&&(y=w[C+1][V+1],N=[C+1,V+1]))}return y!==0&&{oldValue:N[0]-y,newValue:N[1]-y,length:y}}(t,s,n,a);u?(r.push(u),mt([],new Array(u.length),!0).map(o).forEach(function(f){return function(h,m,p,y){h[p.oldValue+y]=!0,m[p.newValue+y]=!0}(n,a,u,f)})):l=!0};!l;)d();return i.subsets=r,i.subsetsAge=100,r},qt=function(){function i(){this.list=[]}return i.prototype.add=function(e){var t;(t=this.list).push.apply(t,e)},i.prototype.forEach=function(e){this.list.forEach(function(t){return e(t)})},i}();function Dt(i,e){var t,s,n=i;for(e=e.slice();e.length>0;)s=e.splice(0,1)[0],t=n,n=n.childNodes?n.childNodes[s]:void 0;return{node:n,parentNode:t,nodeIndex:s}}function Bt(i,e,t){return e.forEach(function(s){(function(n,a,r){var o,l,d,u;if(![r._const.addElement,r._const.addTextElement].includes(a[r._const.action])){var f=Dt(n,a[r._const.route]);l=f.node,d=f.parentNode,u=f.nodeIndex}var h,m,p=[],y={diff:a,node:l};if(r.preVirtualDiffApply(y))return!0;switch(a[r._const.action]){case r._const.addAttribute:l.attributes||(l.attributes={}),l.attributes[a[r._const.name]]=a[r._const.value],a[r._const.name]==="checked"?l.checked=!0:a[r._const.name]==="selected"?l.selected=!0:l.nodeName==="INPUT"&&a[r._const.name]==="value"&&(l.value=a[r._const.value]);break;case r._const.modifyAttribute:l.attributes[a[r._const.name]]=a[r._const.newValue];break;case r._const.removeAttribute:delete l.attributes[a[r._const.name]],Object.keys(l.attributes).length===0&&delete l.attributes,a[r._const.name]==="checked"?l.checked=!1:a[r._const.name]==="selected"?delete l.selected:l.nodeName==="INPUT"&&a[r._const.name]==="value"&&delete l.value;break;case r._const.modifyTextElement:l.data=a[r._const.newValue],d.nodeName==="TEXTAREA"&&(d.value=a[r._const.newValue]);break;case r._const.modifyValue:l.value=a[r._const.newValue];break;case r._const.modifyComment:l.data=a[r._const.newValue];break;case r._const.modifyChecked:l.checked=a[r._const.newValue];break;case r._const.modifySelected:l.selected=a[r._const.newValue];break;case r._const.replaceElement:h=j(a[r._const.newValue]),d.childNodes[u]=h;break;case r._const.relocateGroup:l.childNodes.splice(a[r._const.from],a[r._const.groupLength]).reverse().forEach(function(c){return l.childNodes.splice(a[r._const.to],0,c)}),l.subsets&&l.subsets.forEach(function(c){if(a[r._const.from]<a[r._const.to]&&c.oldValue<=a[r._const.to]&&c.oldValue>a[r._const.from])c.oldValue-=a[r._const.groupLength],(w=c.oldValue+c.length-a[r._const.to])>0&&(p.push({oldValue:a[r._const.to]+a[r._const.groupLength],newValue:c.newValue+c.length-w,length:w}),c.length-=w);else if(a[r._const.from]>a[r._const.to]&&c.oldValue>a[r._const.to]&&c.oldValue<a[r._const.from]){var w;c.oldValue+=a[r._const.groupLength],(w=c.oldValue+c.length-a[r._const.to])>0&&(p.push({oldValue:a[r._const.to]+a[r._const.groupLength],newValue:c.newValue+c.length-w,length:w}),c.length-=w)}else c.oldValue===a[r._const.from]&&(c.oldValue=a[r._const.to])});break;case r._const.removeElement:d.childNodes.splice(u,1),d.subsets&&d.subsets.forEach(function(c){c.oldValue>u?c.oldValue-=1:c.oldValue===u?c.delete=!0:c.oldValue<u&&c.oldValue+c.length>u&&(c.oldValue+c.length-1===u?c.length--:(p.push({newValue:c.newValue+u-c.oldValue,oldValue:u,length:c.length-u+c.oldValue-1}),c.length=u-c.oldValue))}),l=d;break;case r._const.addElement:var N=(m=a[r._const.route].slice()).splice(m.length-1,1)[0];l=(o=Dt(n,m))===null||o===void 0?void 0:o.node,h=j(a[r._const.element]),l.childNodes||(l.childNodes=[]),N>=l.childNodes.length?l.childNodes.push(h):l.childNodes.splice(N,0,h),l.subsets&&l.subsets.forEach(function(c){if(c.oldValue>=N)c.oldValue+=1;else if(c.oldValue<N&&c.oldValue+c.length>N){var w=c.oldValue+c.length-N;p.push({newValue:c.newValue+c.length-w,oldValue:N+1,length:w}),c.length-=w}});break;case r._const.removeTextElement:d.childNodes.splice(u,1),d.nodeName==="TEXTAREA"&&delete d.value,d.subsets&&d.subsets.forEach(function(c){c.oldValue>u?c.oldValue-=1:c.oldValue===u?c.delete=!0:c.oldValue<u&&c.oldValue+c.length>u&&(c.oldValue+c.length-1===u?c.length--:(p.push({newValue:c.newValue+u-c.oldValue,oldValue:u,length:c.length-u+c.oldValue-1}),c.length=u-c.oldValue))}),l=d;break;case r._const.addTextElement:var E=(m=a[r._const.route].slice()).splice(m.length-1,1)[0];h={nodeName:"#text",data:a[r._const.value]},(l=Dt(n,m).node).childNodes||(l.childNodes=[]),E>=l.childNodes.length?l.childNodes.push(h):l.childNodes.splice(E,0,h),l.nodeName==="TEXTAREA"&&(l.value=a[r._const.newValue]),l.subsets&&l.subsets.forEach(function(c){if(c.oldValue>=E&&(c.oldValue+=1),c.oldValue<E&&c.oldValue+c.length>E){var w=c.oldValue+c.length-E;p.push({newValue:c.newValue+c.length-w,oldValue:E+1,length:w}),c.length-=w}});break;default:console.log("unknown action")}l.subsets&&(l.subsets=l.subsets.filter(function(c){return!c.delete&&c.oldValue!==c.newValue}),p.length&&(l.subsets=l.subsets.concat(p))),r.postVirtualDiffApply({node:y.node,diff:y.diff,newNode:h})})(i,s,t)}),!0}function nt(i,e){e===void 0&&(e={valueDiffing:!0});var t={nodeName:i.nodeName};return I(i,"Text","Comment")?t.data=i.data:(i.attributes&&i.attributes.length>0&&(t.attributes={},Array.prototype.slice.call(i.attributes).forEach(function(s){return t.attributes[s.name]=s.value})),i.childNodes&&i.childNodes.length>0&&(t.childNodes=[],Array.prototype.slice.call(i.childNodes).forEach(function(s){return t.childNodes.push(nt(s,e))})),e.valueDiffing&&(I(i,"HTMLTextAreaElement")&&(t.value=i.value),I(i,"HTMLInputElement")&&["radio","checkbox"].includes(i.type.toLowerCase())&&i.checked!==void 0?t.checked=i.checked:I(i,"HTMLButtonElement","HTMLDataElement","HTMLInputElement","HTMLLIElement","HTMLMeterElement","HTMLOptionElement","HTMLProgressElement","HTMLParamElement")&&(t.value=i.value),I(i,"HTMLOptionElement")&&(t.selected=i.selected))),t}var zt=/<\s*\/*[a-zA-Z:_][a-zA-Z0-9:_\-.]*\s*(?:"[^"]*"['"]*|'[^']*'['"]*|[^'"/>])*\/*\s*>|<!--(?:.|\n|\r)*?-->/g,Ut=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function St(i){return i.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}var Jt={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuItem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},kt=function(i,e){var t={nodeName:"",attributes:{}},s=!1,n=i.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.nodeName=e||n[1]==="svg"?n[1]:n[1].toUpperCase(),(Jt[n[1]]||i.charAt(i.length-2)==="/")&&(s=!0),t.nodeName.startsWith("!--"))){var a=i.indexOf("-->");return{type:"comment",node:{nodeName:"#comment",data:a!==-1?i.slice(4,a):""},voidElement:s}}for(var r=new RegExp(Ut),o=null,l=!1;!l;)if((o=r.exec(i))===null)l=!0;else if(o[0].trim())if(o[1]){var d=o[1].trim(),u=[d,""];d.indexOf("=")>-1&&(u=d.split("=")),t.attributes[u[0]]=u[1],r.lastIndex--}else o[2]&&(t.attributes[o[2]]=o[3].trim().substring(1,o[3].length-1));return{type:"tag",node:t,voidElement:s}},at=function(i,e){e===void 0&&(e={valueDiffing:!0,caseSensitive:!1});var t,s=[],n=-1,a=[],r=!1;if(i.indexOf("<")!==0){var o=i.indexOf("<");s.push({nodeName:"#text",data:o===-1?i:i.substring(0,o)})}return i.replace(zt,function(l,d){var u=l.charAt(1)!=="/",f=l.startsWith("<!--"),h=d+l.length,m=i.charAt(h);if(f){var p=kt(l,e.caseSensitive).node;if(n<0)return s.push(p),"";var y=a[n];return y&&p.nodeName&&(y.node.childNodes||(y.node.childNodes=[]),y.node.childNodes.push(p)),""}if(u){if((t=kt(l,e.caseSensitive||r)).node.nodeName==="svg"&&(r=!0),n++,!t.voidElement&&m&&m!=="<"){t.node.childNodes||(t.node.childNodes=[]);var N=St(i.slice(h,i.indexOf("<",h)));t.node.childNodes.push({nodeName:"#text",data:N}),e.valueDiffing&&t.node.nodeName==="TEXTAREA"&&(t.node.value=N)}n===0&&t.node.nodeName&&s.push(t.node);var E=a[n-1];E&&t.node.nodeName&&(E.node.childNodes||(E.node.childNodes=[]),E.node.childNodes.push(t.node)),a[n]=t}if((!u||t.voidElement)&&(n>-1&&(t.voidElement||e.caseSensitive&&t.node.nodeName===l.slice(2,-1)||!e.caseSensitive&&t.node.nodeName.toUpperCase()===l.slice(2,-1).toUpperCase())&&--n>-1&&(t.node.nodeName==="svg"&&(r=!1),t=a[n]),m!=="<"&&m)){var c=n===-1?s:a[n].node.childNodes||[],w=i.indexOf("<",h);N=St(i.slice(h,w===-1?void 0:w)),c.push({nodeName:"#text",data:N})}return""}),s[0]},Wt=function(){function i(e,t,s){this.options=s,this.t1=typeof Element<"u"&&I(e,"Element")?nt(e,this.options):typeof e=="string"?at(e,this.options):JSON.parse(JSON.stringify(e)),this.t2=typeof Element<"u"&&I(t,"Element")?nt(t,this.options):typeof t=="string"?at(t,this.options):JSON.parse(JSON.stringify(t)),this.diffcount=0,this.foundAll=!1,this.debug&&(this.t1Orig=typeof Element<"u"&&I(e,"Element")?nt(e,this.options):typeof e=="string"?at(e,this.options):JSON.parse(JSON.stringify(e)),this.t2Orig=typeof Element<"u"&&I(t,"Element")?nt(t,this.options):typeof t=="string"?at(t,this.options):JSON.parse(JSON.stringify(t))),this.tracker=new qt}return i.prototype.init=function(){return this.findDiffs(this.t1,this.t2)},i.prototype.findDiffs=function(e,t){var s;do{if(this.options.debug&&(this.diffcount+=1,this.diffcount>this.options.diffcap))throw new Error("surpassed diffcap:".concat(JSON.stringify(this.t1Orig)," -> ").concat(JSON.stringify(this.t2Orig)));(s=this.findNextDiff(e,t,[])).length===0&&(xt(e,t)||(this.foundAll?console.error("Could not find remaining diffs!"):(this.foundAll=!0,Pt(e),s=this.findNextDiff(e,t,[])))),s.length>0&&(this.foundAll=!1,this.tracker.add(s),Bt(e,s,this.options))}while(s.length>0);return this.tracker.list},i.prototype.findNextDiff=function(e,t,s){var n,a;if(this.options.maxDepth&&s.length>this.options.maxDepth)return[];if(!e.outerDone){if(n=this.findOuterDiff(e,t,s),this.options.filterOuterDiff&&(a=this.options.filterOuterDiff(e,t,n))&&(n=a),n.length>0)return e.outerDone=!0,n;e.outerDone=!0}if(Object.prototype.hasOwnProperty.call(e,"data"))return[];if(!e.innerDone){if((n=this.findInnerDiff(e,t,s)).length>0)return n;e.innerDone=!0}if(this.options.valueDiffing&&!e.valueDone){if((n=this.findValueDiff(e,t,s)).length>0)return e.valueDone=!0,n;e.valueDone=!0}return[]},i.prototype.findOuterDiff=function(e,t,s){var n,a,r,o,l,d,u=[];if(e.nodeName!==t.nodeName){if(!s.length)throw new Error("Top level nodes have to be of the same kind.");return[new P().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,j(e)).setValue(this.options._const.newValue,j(t)).setValue(this.options._const.route,s)]}if(s.length&&this.options.diffcap<Math.abs((e.childNodes||[]).length-(t.childNodes||[]).length))return[new P().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,j(e)).setValue(this.options._const.newValue,j(t)).setValue(this.options._const.route,s)];if(Object.prototype.hasOwnProperty.call(e,"data")&&e.data!==t.data)return e.nodeName==="#text"?[new P().setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,s).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)]:[new P().setValue(this.options._const.action,this.options._const.modifyComment).setValue(this.options._const.route,s).setValue(this.options._const.oldValue,e.data).setValue(this.options._const.newValue,t.data)];for(a=e.attributes?Object.keys(e.attributes).sort():[],r=t.attributes?Object.keys(t.attributes).sort():[],o=a.length,d=0;d<o;d++)n=a[d],(l=r.indexOf(n))===-1?u.push(new P().setValue(this.options._const.action,this.options._const.removeAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,n).setValue(this.options._const.value,e.attributes[n])):(r.splice(l,1),e.attributes[n]!==t.attributes[n]&&u.push(new P().setValue(this.options._const.action,this.options._const.modifyAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,n).setValue(this.options._const.oldValue,e.attributes[n]).setValue(this.options._const.newValue,t.attributes[n])));for(o=r.length,d=0;d<o;d++)n=r[d],u.push(new P().setValue(this.options._const.action,this.options._const.addAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,n).setValue(this.options._const.value,t.attributes[n]));return u},i.prototype.findInnerDiff=function(e,t,s){var n=e.childNodes?e.childNodes.slice():[],a=t.childNodes?t.childNodes.slice():[],r=Math.max(n.length,a.length),o=Math.abs(n.length-a.length),l=[],d=0;if(!this.options.maxChildCount||r<this.options.maxChildCount){var u=!!(e.subsets&&e.subsetsAge--),f=u?e.subsets:e.childNodes&&t.childNodes?Ft(e,t):[];if(f.length>0&&(l=this.attemptGroupRelocation(e,t,f,s,u)).length>0)return l}for(var h=0;h<r;h+=1){var m=n[h],p=a[h];o&&(m&&!p?m.nodeName==="#text"?(l.push(new P().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,m.data)),d-=1):(l.push(new P().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.element,j(m))),d-=1):p&&!m&&(p.nodeName==="#text"?l.push(new P().setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,p.data)):l.push(new P().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.element,j(p))))),m&&p&&(!this.options.maxChildCount||r<this.options.maxChildCount?l=l.concat(this.findNextDiff(m,p,s.concat(d))):xt(m,p)||(n.length>a.length?(m.nodeName==="#text"?l.push(new P().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,m.data)):l.push(new P().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.element,j(m)).setValue(this.options._const.route,s.concat(d))),n.splice(h,1),h-=1,d-=1,o-=1):n.length<a.length?(l=l.concat([new P().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.element,j(p)).setValue(this.options._const.route,s.concat(d))]),n.splice(h,0,j(p)),o-=1):l=l.concat([new P().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,j(m)).setValue(this.options._const.newValue,j(p)).setValue(this.options._const.route,s.concat(d))]))),d+=1}return e.innerDone=!0,l},i.prototype.attemptGroupRelocation=function(e,t,s,n,a){for(var r,o,l,d,u,f=function(C,L,V){var O=C.childNodes?ft(C.childNodes.length,!0):[],T=L.childNodes?ft(L.childNodes.length,!0):[],R=0;return V.forEach(function(_){for(var b=_.oldValue+_.length,g=_.newValue+_.length,D=_.oldValue;D<b;D+=1)O[D]=R;for(D=_.newValue;D<g;D+=1)T[D]=R;R+=1}),{gaps1:O,gaps2:T}}(e,t,s),h=f.gaps1,m=f.gaps2,p=e.childNodes.slice(),y=t.childNodes.slice(),N=Math.min(h.length,m.length),E=[],c=0,w=0;c<N;w+=1,c+=1)if(!a||h[c]!==!0&&m[c]!==!0){if(h[w]===!0)if((d=p[w]).nodeName==="#text")if(y[c].nodeName==="#text"){if(d.data!==y[c].data){for(var k=w;p.length>k+1&&p[k+1].nodeName==="#text";)if(k+=1,y[c].data===p[k].data){u=!0;break}u||E.push(new P().setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,n.concat(w)).setValue(this.options._const.oldValue,d.data).setValue(this.options._const.newValue,y[c].data))}}else E.push(new P().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,n.concat(w)).setValue(this.options._const.value,d.data)),h.splice(w,1),p.splice(w,1),N=Math.min(h.length,m.length),w-=1,c-=1;else m[c]===!0?E.push(new P().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,j(d)).setValue(this.options._const.newValue,j(y[c])).setValue(this.options._const.route,n.concat(w))):(E.push(new P().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,n.concat(w)).setValue(this.options._const.element,j(d))),h.splice(w,1),p.splice(w,1),N=Math.min(h.length,m.length),w-=1,c-=1);else if(m[c]===!0)(d=y[c]).nodeName==="#text"?(E.push(new P().setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,n.concat(w)).setValue(this.options._const.value,d.data)),h.splice(w,0,!0),p.splice(w,0,{nodeName:"#text",data:d.data}),N=Math.min(h.length,m.length)):(E.push(new P().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,n.concat(w)).setValue(this.options._const.element,j(d))),h.splice(w,0,!0),p.splice(w,0,j(d)),N=Math.min(h.length,m.length));else if(h[w]!==m[c]){if(E.length>0)return E;if(l=s[h[w]],(o=Math.min(l.newValue,p.length-l.length))!==l.oldValue){r=!1;for(var S=0;S<l.length;S+=1)Vt(p[o+S],p[l.oldValue+S],{},!1,!0)||(r=!0);if(r)return[new P().setValue(this.options._const.action,this.options._const.relocateGroup).setValue(this.options._const.groupLength,l.length).setValue(this.options._const.from,l.oldValue).setValue(this.options._const.to,o).setValue(this.options._const.route,n)]}}}return E},i.prototype.findValueDiff=function(e,t,s){var n=[];return e.selected!==t.selected&&n.push(new P().setValue(this.options._const.action,this.options._const.modifySelected).setValue(this.options._const.oldValue,e.selected).setValue(this.options._const.newValue,t.selected).setValue(this.options._const.route,s)),(e.value||t.value)&&e.value!==t.value&&e.nodeName!=="OPTION"&&n.push(new P().setValue(this.options._const.action,this.options._const.modifyValue).setValue(this.options._const.oldValue,e.value||"").setValue(this.options._const.newValue,t.value||"").setValue(this.options._const.route,s)),e.checked!==t.checked&&n.push(new P().setValue(this.options._const.action,this.options._const.modifyChecked).setValue(this.options._const.oldValue,e.checked).setValue(this.options._const.newValue,t.checked).setValue(this.options._const.route,s)),n},i}(),Qt={debug:!1,diffcap:10,maxDepth:!1,maxChildCount:50,valueDiffing:!0,textDiff:function(i,e,t,s){i.data=s},preVirtualDiffApply:function(){},postVirtualDiffApply:function(){},preDiffApply:function(){},postDiffApply:function(){},filterOuterDiff:null,compress:!1,_const:!1,document:!(typeof window>"u"||!window.document)&&window.document,components:[]},Xt=function(){function i(e){if(e===void 0&&(e={}),Object.entries(Qt).forEach(function(n){var a=n[0],r=n[1];Object.prototype.hasOwnProperty.call(e,a)||(e[a]=r)}),!e._const){var t=["addAttribute","modifyAttribute","removeAttribute","modifyTextElement","relocateGroup","removeElement","addElement","removeTextElement","addTextElement","replaceElement","modifyValue","modifyChecked","modifySelected","modifyComment","action","route","oldValue","newValue","element","group","groupLength","from","to","name","value","data","attributes","nodeName","childNodes","checked","selected"],s={};e.compress?t.forEach(function(n,a){return s[n]=a}):t.forEach(function(n){return s[n]=n}),e._const=s}this.options=e}return i.prototype.apply=function(e,t){return function(s,n,a){return n.every(function(r){return G(s,r,a)})}(e,t,this.options)},i.prototype.undo=function(e,t){return jt(e,t,this.options)},i.prototype.diff=function(e,t){return new Wt(e,t,this.options).init()},i}();const Et=(i,e,t,{classes:s,format:n,hiddenHeader:a,sortable:r,scrollY:o,type:l},{noColumnWidths:d,unhideHeader:u})=>({nodeName:"TR",childNodes:i.map((f,h)=>{const m=e[h]||{type:l,format:n,sortable:!0,searchable:!0};if(m.hidden)return;const p=f.attributes?{...f.attributes}:{};if(m.sortable&&r&&(!o.length||u)&&(m.filter?p["data-filterable"]="true":p["data-sortable"]="true"),m.headerClass&&(p.class=X(p.class,m.headerClass)),t.sort&&t.sort.column===h){const N=t.sort.dir==="asc"?s.ascending:s.descending;p.class=X(p.class,N),p["aria-sort"]=t.sort.dir==="asc"?"ascending":"descending"}else t.filters[h]&&(p.class=X(p.class,s.filterActive));if(t.widths[h]&&!d){const N=`width: ${t.widths[h]}%;`;p.style=X(p.style,N)}if(o.length&&!u){const N="padding-bottom: 0;padding-top: 0;border: 0;";p.style=X(p.style,N)}const y=f.type==="html"?f.data:[{nodeName:"#text",data:f.text??String(f.data)}];return{nodeName:"TH",attributes:p,childNodes:!a&&!o.length||u?m.sortable&&r?[{nodeName:"BUTTON",attributes:{class:m.filter?s.filter:s.sorter},childNodes:y}]:y:[{nodeName:"#text",data:""}]}}).filter(f=>f)}),Tt=(i,e,t,s,n,a,{classes:r,hiddenHeader:o,header:l,footer:d,format:u,sortable:f,scrollY:h,type:m,rowRender:p,tabIndex:y},{noColumnWidths:N,unhideHeader:E,renderHeader:c},w,k)=>{const S={nodeName:"TABLE",attributes:{...i},childNodes:[{nodeName:"TBODY",childNodes:t.map(({row:C,index:L})=>{const V={nodeName:"TR",attributes:{...C.attributes,"data-index":String(L)},childNodes:C.cells.map((O,T)=>{const R=s[T]||{type:m,format:u,sortable:!0,searchable:!0};if(R.hidden)return;const _={nodeName:"TD",attributes:O.attributes?{...O.attributes}:{},childNodes:R.type==="html"?O.data:[{nodeName:"#text",data:z(O)}]};if(l||d||!n.widths[T]||N||(_.attributes.style=X(_.attributes.style,`width: ${n.widths[T]}%;`)),R.cellClass&&(_.attributes.class=X(_.attributes.class,R.cellClass)),R.render){const b=R.render(O.data,_,L,T);if(b){if(typeof b!="string")return b;{const g=at(`<td>${b}</td>`);g.childNodes.length===1&&["#text","#comment"].includes(g.childNodes[0].nodeName)?_.childNodes[0].data=b:_.childNodes=g.childNodes}}}return _}).filter(O=>O)};if(L===a&&(V.attributes.class=X(V.attributes.class,r.cursor)),p){const O=p(C,V,L);if(O){if(typeof O!="string")return O;{const T=at(`<tr>${O}</tr>`);!T.childNodes||T.childNodes.length===1&&["#text","#comment"].includes(T.childNodes[0].nodeName)?V.childNodes[0].data=O:V.childNodes=T.childNodes}}}return V})}]};if(S.attributes.class=X(S.attributes.class,r.table),l||d||c){const C=Et(e,s,n,{classes:r,hiddenHeader:o,sortable:f,scrollY:h},{noColumnWidths:N,unhideHeader:E});if(l||c){const L={nodeName:"THEAD",childNodes:[C]};!h.length&&!o||E||(L.attributes={style:"height: 0px;"}),S.childNodes.unshift(L)}if(d){const L={nodeName:"TFOOT",childNodes:[l?structuredClone(C):C]};!h.length&&!o||E||(L.attributes={style:"height: 0px;"}),S.childNodes.push(L)}}return w.forEach(C=>S.childNodes.push(C)),k.forEach(C=>S.childNodes.push(C)),y!==!1&&(S.attributes.tabindex=String(y)),S};function Rt(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var dt=Rt(function(){var i=1e3,e=6e4,t=36e5,s="millisecond",n="second",a="minute",r="hour",o="day",l="week",d="month",u="quarter",f="year",h="date",m="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(_){var b=["th","st","nd","rd"],g=_%100;return"["+_+(b[(g-20)%10]||b[g]||b[0])+"]"}},E=function(_,b,g){var D=String(_);return!D||D.length>=b?_:""+Array(b+1-D.length).join(g)+_},c={s:E,z:function(_){var b=-_.utcOffset(),g=Math.abs(b),D=Math.floor(g/60),v=g%60;return(b<=0?"+":"-")+E(D,2,"0")+":"+E(v,2,"0")},m:function _(b,g){if(b.date()<g.date())return-_(g,b);var D=12*(g.year()-b.year())+(g.month()-b.month()),v=b.clone().add(D,d),x=g-v<0,$=b.clone().add(D+(x?-1:1),d);return+(-(D+(g-v)/(x?v-$:$-v))||0)},a:function(_){return _<0?Math.ceil(_)||0:Math.floor(_)},p:function(_){return{M:d,y:f,w:l,d:o,D:h,h:r,m:a,s:n,ms:s,Q:u}[_]||String(_||"").toLowerCase().replace(/s$/,"")},u:function(_){return _===void 0}},w="en",k={};k[w]=N;var S="$isDayjsObject",C=function(_){return _ instanceof T||!(!_||!_[S])},L=function _(b,g,D){var v;if(!b)return w;if(typeof b=="string"){var x=b.toLowerCase();k[x]&&(v=x),g&&(k[x]=g,v=x);var $=b.split("-");if(!v&&$.length>1)return _($[0])}else{var A=b.name;k[A]=b,v=A}return!D&&v&&(w=v),v||!D&&w},V=function(_,b){if(C(_))return _.clone();var g=typeof b=="object"?b:{};return g.date=_,g.args=arguments,new T(g)},O=c;O.l=L,O.i=C,O.w=function(_,b){return V(_,{locale:b.$L,utc:b.$u,x:b.$x,$offset:b.$offset})};var T=function(){function _(g){this.$L=L(g.locale,null,!0),this.parse(g),this.$x=this.$x||g.x||{},this[S]=!0}var b=_.prototype;return b.parse=function(g){this.$d=function(D){var v=D.date,x=D.utc;if(v===null)return new Date(NaN);if(O.u(v))return new Date;if(v instanceof Date)return new Date(v);if(typeof v=="string"&&!/Z$/i.test(v)){var $=v.match(p);if($){var A=$[2]-1||0,H=($[7]||"0").substring(0,3);return x?new Date(Date.UTC($[1],A,$[3]||1,$[4]||0,$[5]||0,$[6]||0,H)):new Date($[1],A,$[3]||1,$[4]||0,$[5]||0,$[6]||0,H)}}return new Date(v)}(g),this.init()},b.init=function(){var g=this.$d;this.$y=g.getFullYear(),this.$M=g.getMonth(),this.$D=g.getDate(),this.$W=g.getDay(),this.$H=g.getHours(),this.$m=g.getMinutes(),this.$s=g.getSeconds(),this.$ms=g.getMilliseconds()},b.$utils=function(){return O},b.isValid=function(){return this.$d.toString()!==m},b.isSame=function(g,D){var v=V(g);return this.startOf(D)<=v&&v<=this.endOf(D)},b.isAfter=function(g,D){return V(g)<this.startOf(D)},b.isBefore=function(g,D){return this.endOf(D)<V(g)},b.$g=function(g,D,v){return O.u(g)?this[D]:this.set(v,g)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(g,D){var v=this,x=!!O.u(D)||D,$=O.p(g),A=function(Q,q){var W=O.w(v.$u?Date.UTC(v.$y,q,Q):new Date(v.$y,q,Q),v);return x?W:W.endOf(o)},H=function(Q,q){return O.w(v.toDate()[Q].apply(v.toDate("s"),(x?[0,0,0,0]:[23,59,59,999]).slice(q)),v)},Y=this.$W,F=this.$M,J=this.$D,st="set"+(this.$u?"UTC":"");switch($){case f:return x?A(1,0):A(31,11);case d:return x?A(1,F):A(0,F+1);case l:var Z=this.$locale().weekStart||0,K=(Y<Z?Y+7:Y)-Z;return A(x?J-K:J+(6-K),F);case o:case h:return H(st+"Hours",0);case r:return H(st+"Minutes",1);case a:return H(st+"Seconds",2);case n:return H(st+"Milliseconds",3);default:return this.clone()}},b.endOf=function(g){return this.startOf(g,!1)},b.$set=function(g,D){var v,x=O.p(g),$="set"+(this.$u?"UTC":""),A=(v={},v[o]=$+"Date",v[h]=$+"Date",v[d]=$+"Month",v[f]=$+"FullYear",v[r]=$+"Hours",v[a]=$+"Minutes",v[n]=$+"Seconds",v[s]=$+"Milliseconds",v)[x],H=x===o?this.$D+(D-this.$W):D;if(x===d||x===f){var Y=this.clone().set(h,1);Y.$d[A](H),Y.init(),this.$d=Y.set(h,Math.min(this.$D,Y.daysInMonth())).$d}else A&&this.$d[A](H);return this.init(),this},b.set=function(g,D){return this.clone().$set(g,D)},b.get=function(g){return this[O.p(g)]()},b.add=function(g,D){var v,x=this;g=Number(g);var $=O.p(D),A=function(F){var J=V(x);return O.w(J.date(J.date()+Math.round(F*g)),x)};if($===d)return this.set(d,this.$M+g);if($===f)return this.set(f,this.$y+g);if($===o)return A(1);if($===l)return A(7);var H=(v={},v[a]=e,v[r]=t,v[n]=i,v)[$]||1,Y=this.$d.getTime()+g*H;return O.w(Y,this)},b.subtract=function(g,D){return this.add(-1*g,D)},b.format=function(g){var D=this,v=this.$locale();if(!this.isValid())return v.invalidDate||m;var x=g||"YYYY-MM-DDTHH:mm:ssZ",$=O.z(this),A=this.$H,H=this.$m,Y=this.$M,F=v.weekdays,J=v.months,st=v.meridiem,Z=function(q,W,tt,it){return q&&(q[W]||q(D,x))||tt[W].slice(0,it)},K=function(q){return O.s(A%12||12,q,"0")},Q=st||function(q,W,tt){var it=q<12?"AM":"PM";return tt?it.toLowerCase():it};return x.replace(y,function(q,W){return W||function(tt){switch(tt){case"YY":return String(D.$y).slice(-2);case"YYYY":return O.s(D.$y,4,"0");case"M":return Y+1;case"MM":return O.s(Y+1,2,"0");case"MMM":return Z(v.monthsShort,Y,J,3);case"MMMM":return Z(J,Y);case"D":return D.$D;case"DD":return O.s(D.$D,2,"0");case"d":return String(D.$W);case"dd":return Z(v.weekdaysMin,D.$W,F,2);case"ddd":return Z(v.weekdaysShort,D.$W,F,3);case"dddd":return F[D.$W];case"H":return String(A);case"HH":return O.s(A,2,"0");case"h":return K(1);case"hh":return K(2);case"a":return Q(A,H,!0);case"A":return Q(A,H,!1);case"m":return String(H);case"mm":return O.s(H,2,"0");case"s":return String(D.$s);case"ss":return O.s(D.$s,2,"0");case"SSS":return O.s(D.$ms,3,"0");case"Z":return $}return null}(q)||$.replace(":","")})},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(g,D,v){var x,$=this,A=O.p(D),H=V(g),Y=(H.utcOffset()-this.utcOffset())*e,F=this-H,J=function(){return O.m($,H)};switch(A){case f:x=J()/12;break;case d:x=J();break;case u:x=J()/3;break;case l:x=(F-Y)/6048e5;break;case o:x=(F-Y)/864e5;break;case r:x=F/t;break;case a:x=F/e;break;case n:x=F/i;break;default:x=F}return v?x:O.a(x)},b.daysInMonth=function(){return this.endOf(d).$D},b.$locale=function(){return k[this.$L]},b.locale=function(g,D){if(!g)return this.$L;var v=this.clone(),x=L(g,D,!0);return x&&(v.$L=x),v},b.clone=function(){return O.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},_}(),R=T.prototype;return V.prototype=R,[["$ms",s],["$s",n],["$m",a],["$H",r],["$W",o],["$M",d],["$y",f],["$D",h]].forEach(function(_){R[_[1]]=function(b){return this.$g(b,_[0],_[1])}}),V.extend=function(_,b){return _.$i||(_(b,T,V),_.$i=!0),V},V.locale=L,V.isDayjs=C,V.unix=function(_){return V(1e3*_)},V.en=k[w],V.Ls=k,V.p={},V}()),Zt=Rt(function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},e=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,t=/\d\d/,s=/\d\d?/,n=/\d*[^-_:/,()\s\d]+/,a={},r=function(m){return(m=+m)+(m>68?1900:2e3)},o=function(m){return function(p){this[m]=+p}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(m){(this.zone||(this.zone={})).offset=function(p){if(!p||p==="Z")return 0;var y=p.match(/([+-]|\d\d)/g),N=60*y[1]+(+y[2]||0);return N===0?0:y[0]==="+"?-N:N}(m)}],d=function(m){var p=a[m];return p&&(p.indexOf?p:p.s.concat(p.f))},u=function(m,p){var y,N=a.meridiem;if(N){for(var E=1;E<=24;E+=1)if(m.indexOf(N(E,0,p))>-1){y=E>12;break}}else y=m===(p?"pm":"PM");return y},f={A:[n,function(m){this.afternoon=u(m,!1)}],a:[n,function(m){this.afternoon=u(m,!0)}],S:[/\d/,function(m){this.milliseconds=100*+m}],SS:[t,function(m){this.milliseconds=10*+m}],SSS:[/\d{3}/,function(m){this.milliseconds=+m}],s:[s,o("seconds")],ss:[s,o("seconds")],m:[s,o("minutes")],mm:[s,o("minutes")],H:[s,o("hours")],h:[s,o("hours")],HH:[s,o("hours")],hh:[s,o("hours")],D:[s,o("day")],DD:[t,o("day")],Do:[n,function(m){var p=a.ordinal,y=m.match(/\d+/);if(this.day=y[0],p)for(var N=1;N<=31;N+=1)p(N).replace(/\[|\]/g,"")===m&&(this.day=N)}],M:[s,o("month")],MM:[t,o("month")],MMM:[n,function(m){var p=d("months"),y=(d("monthsShort")||p.map(function(N){return N.slice(0,3)})).indexOf(m)+1;if(y<1)throw new Error;this.month=y%12||y}],MMMM:[n,function(m){var p=d("months").indexOf(m)+1;if(p<1)throw new Error;this.month=p%12||p}],Y:[/[+-]?\d+/,o("year")],YY:[t,function(m){this.year=r(m)}],YYYY:[/\d{4}/,o("year")],Z:l,ZZ:l};function h(m){var p,y;p=m,y=a&&a.formats;for(var N=(m=p.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(L,V,O){var T=O&&O.toUpperCase();return V||y[O]||i[O]||y[T].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(R,_,b){return _||b.slice(1)})})).match(e),E=N.length,c=0;c<E;c+=1){var w=N[c],k=f[w],S=k&&k[0],C=k&&k[1];N[c]=C?{regex:S,parser:C}:w.replace(/^\[|\]$/g,"")}return function(L){for(var V={},O=0,T=0;O<E;O+=1){var R=N[O];if(typeof R=="string")T+=R.length;else{var _=R.regex,b=R.parser,g=L.slice(T),D=_.exec(g)[0];b.call(V,D),L=L.replace(D,"")}}return function(v){var x=v.afternoon;if(x!==void 0){var $=v.hours;x?$<12&&(v.hours+=12):$===12&&(v.hours=0),delete v.afternoon}}(V),V}}return function(m,p,y){y.p.customParseFormat=!0,m&&m.parseTwoDigitYear&&(r=m.parseTwoDigitYear);var N=p.prototype,E=N.parse;N.parse=function(c){var w=c.date,k=c.utc,S=c.args;this.$u=k;var C=S[1];if(typeof C=="string"){var L=S[2]===!0,V=S[3]===!0,O=L||V,T=S[2];V&&(T=S[2]),a=this.$locale(),!L&&T&&(a=y.Ls[T]),this.$d=function(g,D,v){try{if(["x","X"].indexOf(D)>-1)return new Date((D==="X"?1e3:1)*g);var x=h(D)(g),$=x.year,A=x.month,H=x.day,Y=x.hours,F=x.minutes,J=x.seconds,st=x.milliseconds,Z=x.zone,K=new Date,Q=H||($||A?1:K.getDate()),q=$||K.getFullYear(),W=0;$&&!A||(W=A>0?A-1:K.getMonth());var tt=Y||0,it=F||0,bt=J||0,vt=st||0;return Z?new Date(Date.UTC(q,W,Q,tt,it,bt,vt+60*Z.offset*1e3)):v?new Date(Date.UTC(q,W,Q,tt,it,bt,vt)):new Date(q,W,Q,tt,it,bt,vt)}catch{return new Date("")}}(w,C,k),this.init(),T&&T!==!0&&(this.$L=this.locale(T).$L),O&&w!=this.format(C)&&(this.$d=new Date("")),a={}}else if(C instanceof Array)for(var R=C.length,_=1;_<=R;_+=1){S[1]=C[_-1];var b=y.apply(this,S);if(b.isValid()){this.$d=b.$d,this.$L=b.$L,this.init();break}_===R&&(this.$d=new Date(""))}else E.call(this,c)}}}());dt.extend(Zt);const gt=(i,e)=>{let t;if(e)switch(e){case"ISO_8601":t=i;break;case"RFC_2822":t=dt(i.slice(5),"DD MMM YYYY HH:mm:ss ZZ").unix();break;case"MYSQL":t=dt(i,"YYYY-MM-DD hh:mm:ss").unix();break;case"UNIX":t=dt(i).unix();break;default:t=dt(i,e,!0).valueOf()}return t},ot=(i,e)=>{if((i==null?void 0:i.constructor)===Object&&Object.prototype.hasOwnProperty.call(i,"data")&&!Object.keys(i).find(s=>!["text","order","data","attributes"].includes(s)))return i;const t={data:i};switch(e.type){case"string":typeof i!="string"&&(t.text=String(t.data),t.order=t.text);break;case"date":e.format&&(t.order=gt(String(t.data),e.format));break;case"number":t.text=String(t.data),t.data=parseFloat(t.data),t.order=t.data;break;case"html":{const s=Array.isArray(t.data)?{nodeName:"TD",childNodes:t.data}:at(`<td>${String(t.data)}</td>`);t.data=s.childNodes||[];const n=ht(s);t.text=n,t.order=n;break}case"boolean":typeof t.data=="string"&&(t.data=t.data.toLowerCase().trim()),t.data=!["false",!1,null,void 0,0].includes(t.data),t.order=t.data?1:0,t.text=String(t.data);break;case"other":t.text="",t.order=0;break;default:t.text=JSON.stringify(t.data)}return t},ct=i=>{if(i instanceof Object&&i.constructor===Object&&i.hasOwnProperty("data")&&(typeof i.text=="string"||typeof i.data=="string"))return i;const e={data:i};if(typeof i=="string"){if(i.length){const t=at(`<th>${i}</th>`);if(t.childNodes&&(t.childNodes.length!==1||t.childNodes[0].nodeName!=="#text")){e.data=t.childNodes,e.type="html";const s=ht(t);e.text=s}}}else[null,void 0].includes(i)?e.text="":e.text=JSON.stringify(i);return e},At=(i,e=void 0,t,s,n)=>{var r,o;const a={data:[],headings:[]};if(i.headings)a.headings=i.headings.map(l=>ct(l));else if(e!=null&&e.tHead)a.headings=Array.from(e.tHead.querySelectorAll("th")).map((l,d)=>{var h,m,p,y,N;const u=(E=>{const c=nt(E,{valueDiffing:!1});let w;return w=!c.childNodes||c.childNodes.length===1&&c.childNodes[0].nodeName==="#text"?{data:E.innerText,type:"string"}:{data:c.childNodes,type:"html",text:ht(c)},w.attributes=c.attributes,w})(l);t[d]||(t[d]={type:s,format:n,searchable:!0,sortable:!0});const f=t[d];return((h=l.dataset.sortable)==null?void 0:h.trim().toLowerCase())!=="false"&&((m=l.dataset.sort)==null?void 0:m.trim().toLowerCase())!=="false"||(f.sortable=!1),((p=l.dataset.searchable)==null?void 0:p.trim().toLowerCase())==="false"&&(f.searchable=!1),((y=l.dataset.hidden)==null?void 0:y.trim().toLowerCase())!=="true"&&((N=l.getAttribute("hidden"))==null?void 0:N.trim().toLowerCase())!=="true"||(f.hidden=!0),["number","string","html","date","boolean","other"].includes(l.dataset.type)&&(f.type=l.dataset.type,f.type==="date"&&l.dataset.format&&(f.format=l.dataset.format)),u});else if((r=i.data)!=null&&r.length){const l=i.data[0],d=Array.isArray(l)?l:l.cells;a.headings=d.map(u=>ct(""))}else e!=null&&e.tBodies.length&&(a.headings=Array.from(e.tBodies[0].rows[0].cells).map(l=>ct("")));for(let l=0;l<a.headings.length;l++)t[l]||(t[l]={type:s,format:n,sortable:!0,searchable:!0});if(i.data){const l=a.headings.map(d=>d.data?String(d.data):d.text);a.data=i.data.map(d=>{let u,f;return Array.isArray(d)?(u={},f=d):d.hasOwnProperty("cells")&&Object.keys(d).every(h=>["cells","attributes"].includes(h))?(u=d.attributes,f=d.cells):(u={},f=[],Object.entries(d).forEach(([h,m])=>{const p=l.indexOf(h);p>-1&&(f[p]=m)})),{attributes:u,cells:f.map((h,m)=>ot(h,t[m]))}})}else(o=e==null?void 0:e.tBodies)!=null&&o.length&&(a.data=Array.from(e.tBodies[0].rows).map(l=>({attributes:$t(l.attributes),cells:Array.from(l.cells).map((d,u)=>{const f=d.dataset.content?ot(d.dataset.content,t[u]):((h,m)=>{let p;switch(m.type){case"string":p={data:h.innerText};break;case"date":{const y=h.innerText;p={data:y,order:gt(y,m.format)};break}case"number":{const y=parseFloat(h.innerText);p={data:y,order:y,text:h.innerText};break}case"boolean":{const y=!["false","0","null","undefined"].includes(h.innerText.toLowerCase().trim());p={data:y,text:y?"1":"0",order:y?1:0};break}default:p={data:nt(h,{valueDiffing:!1}).childNodes||[],text:h.innerText,order:h.innerText}}return p.attributes=$t(h.attributes),p})(d,t[u]);return d.dataset.order&&(f.order=isNaN(parseFloat(d.dataset.order))?d.dataset.order:parseFloat(d.dataset.order)),f})})));if(a.data.length&&a.data[0].cells.length!==a.headings.length)throw new Error("Data heading length mismatch.");return a};class Gt{constructor(e){M(this,"cursor");M(this,"dt");this.dt=e,this.cursor=!1}setCursor(e=!1){if(e===this.cursor)return;const t=this.cursor;if(this.cursor=e,this.dt._renderTable(),e!==!1&&this.dt.options.scrollY){const s=B(this.dt.options.classes.cursor),n=this.dt.dom.querySelector(`tr${s}`);n&&n.scrollIntoView({block:"nearest"})}this.dt.emit("datatable.cursormove",this.cursor,t)}add(e){if(!Array.isArray(e)||e.length<1)return;const t={cells:e.map((s,n)=>{const a=this.dt.columns.settings[n];return ot(s,a)})};this.dt.data.data.push(t),this.dt.hasRows=!0,this.dt.update(!0)}remove(e){if(!Array.isArray(e))return this.remove([e]);this.dt.data.data=this.dt.data.data.filter((t,s)=>!e.includes(s)),this.dt.data.data.length||(this.dt.hasRows=!1),this.dt.update(!0)}findRowIndex(e,t){return this.dt.data.data.findIndex(s=>{const n=s.cells[e];return z(n).toLowerCase().includes(String(t).toLowerCase())})}findRow(e,t){const s=this.findRowIndex(e,t);if(s<0)return{index:-1,row:null,cols:[]};const n=this.dt.data.data[s],a=n.cells.map(r=>r.data);return{index:s,row:n,cols:a}}updateRow(e,t){const s={cells:t.map((n,a)=>{const r=this.dt.columns.settings[a];return ot(n,r)})};this.dt.data.data.splice(e,1,s),this.dt.update(!0)}}class Kt{constructor(e){M(this,"dt");M(this,"settings");M(this,"_state");this.dt=e,this.init()}init(){[this.settings,this._state]=((e=[],t,s)=>{let n=[],a=!1;const r=[];return e.forEach(o=>{(Array.isArray(o.select)?o.select:[o.select]).forEach(l=>{n[l]?o.type&&(n[l].type=o.type):n[l]={type:o.type||t,sortable:!0,searchable:!0};const d=n[l];o.render&&(d.render=o.render),o.format?d.format=o.format:o.type==="date"&&(d.format=s),o.cellClass&&(d.cellClass=o.cellClass),o.headerClass&&(d.headerClass=o.headerClass),o.locale&&(d.locale=o.locale),o.sortable===!1?d.sortable=!1:(o.numeric&&(d.numeric=o.numeric),o.caseFirst&&(d.caseFirst=o.caseFirst)),o.searchable===!1?d.searchable=!1:o.sensitivity&&(d.sensitivity=o.sensitivity),(d.searchable||d.sortable)&&o.ignorePunctuation!==void 0&&(d.ignorePunctuation=o.ignorePunctuation),o.hidden&&(d.hidden=!0),o.filter&&(d.filter=o.filter),o.sortSequence&&(d.sortSequence=o.sortSequence),o.sort&&(o.filter?r[l]=o.sort:a={column:l,dir:o.sort}),o.searchItemSeparator!==void 0&&(d.searchItemSeparator=o.searchItemSeparator)})}),n=n.map(o=>o||{type:t,format:t==="date"?s:void 0,sortable:!0,searchable:!0}),[n,{filters:r,sort:a,widths:[]}]})(this.dt.options.columns,this.dt.options.type,this.dt.options.format)}get(e){return e<0||e>=this.size()?null:{...this.settings[e]}}size(){return this.settings.length}swap(e){if(e.length===2){const t=this.dt.data.headings.map((r,o)=>o),s=e[0],n=e[1],a=t[n];return t[n]=t[s],t[s]=a,this.order(t)}}order(e){this.dt.data.headings=e.map(t=>this.dt.data.headings[t]),this.dt.data.data.forEach(t=>t.cells=e.map(s=>t.cells[s])),this.settings=e.map(t=>this.settings[t]),this.dt.update()}hide(e){Array.isArray(e)||(e=[e]),e.length&&(e.forEach(t=>{this.settings[t]||(this.settings[t]={type:"string"}),this.settings[t].hidden=!0}),this.dt.update())}show(e){Array.isArray(e)||(e=[e]),e.length&&(e.forEach(t=>{this.settings[t]||(this.settings[t]={type:"string",sortable:!0}),delete this.settings[t].hidden}),this.dt.update())}visible(e){var t;return e===void 0&&(e=[...Array(this.dt.data.headings.length).keys()]),Array.isArray(e)?e.map(s=>{var n;return!((n=this.settings[s])!=null&&n.hidden)}):!((t=this.settings[e])!=null&&t.hidden)}add(e){const t=this.dt.data.headings.length;if(this.dt.data.headings=this.dt.data.headings.concat([ct(e.heading)]),this.dt.data.data.forEach((s,n)=>{s.cells=s.cells.concat([ot(e.data[n],e)])}),this.settings[t]={type:e.type||"string",sortable:!0,searchable:!0},e.type||e.format||e.sortable||e.render||e.filter){const s=this.settings[t];e.render&&(s.render=e.render),e.format&&(s.format=e.format),e.cellClass&&(s.cellClass=e.cellClass),e.headerClass&&(s.headerClass=e.headerClass),e.locale&&(s.locale=e.locale),e.sortable===!1?s.sortable=!1:(e.numeric&&(s.numeric=e.numeric),e.caseFirst&&(s.caseFirst=e.caseFirst)),e.searchable===!1?s.searchable=!1:e.sensitivity&&(s.sensitivity=e.sensitivity),(s.searchable||s.sortable)&&e.ignorePunctuation&&(s.ignorePunctuation=e.ignorePunctuation),e.hidden&&(s.hidden=!0),e.filter&&(s.filter=e.filter),e.sortSequence&&(s.sortSequence=e.sortSequence)}this.dt.update(!0)}remove(e){Array.isArray(e)||(e=[e]),this.dt.data.headings=this.dt.data.headings.filter((t,s)=>!e.includes(s)),this.dt.data.data.forEach(t=>t.cells=t.cells.filter((s,n)=>!e.includes(n))),this.dt.update(!0)}filter(e,t=!1){var a,r;if(!((r=(a=this.settings[e])==null?void 0:a.filter)!=null&&r.length))return;const s=this._state.filters[e];let n;if(s){let o=!1;n=this.settings[e].filter.find(l=>!!o||(l===s&&(o=!0),!1))}else{const o=this.settings[e].filter;n=o?o[0]:void 0}n?this._state.filters[e]=n:s&&(this._state.filters[e]=void 0),this.dt._currentPage=1,this.dt.update(),t||this.dt.emit("datatable.filter",e,n)}sort(e,t=void 0,s=!1){var r;const n=this.settings[e];if(s||this.dt.emit("datatable.sorting",e,t),!t){const o=!(!this._state.sort||this._state.sort.column!==e)&&((r=this._state.sort)==null?void 0:r.dir),l=(n==null?void 0:n.sortSequence)||["asc","desc"];if(o){const d=l.indexOf(o);t=d===-1?l[0]||"asc":d===l.length-1?l[0]:l[d+1]}else t=l.length?l[0]:"asc"}const a=!!["string","html"].includes(n.type)&&new Intl.Collator(n.locale||this.dt.options.locale,{usage:"sort",numeric:n.numeric||this.dt.options.numeric,caseFirst:n.caseFirst||this.dt.options.caseFirst,ignorePunctuation:n.ignorePunctuation||this.dt.options.ignorePunctuation});this.dt.data.data.sort((o,l)=>{const d=o.cells[e],u=l.cells[e];let f=d.order??z(d),h=u.order??z(u);if(t==="desc"){const m=f;f=h,h=m}return a?a.compare(String(f),String(h)):f<h?-1:f>h?1:0}),this._state.sort={column:e,dir:t},this.dt._searchQueries.length?(this.dt.multiSearch(this.dt._searchQueries),this.dt.emit("datatable.sort",e,t)):s||(this.dt._currentPage=1,this.dt.update(),this.dt.emit("datatable.sort",e,t))}_measureWidths(){var t,s,n,a;const e=this.dt.data.headings.filter((r,o)=>{var l;return!((l=this.settings[o])!=null&&l.hidden)});if((this.dt.options.scrollY.length||this.dt.options.fixedColumns)&&(e!=null&&e.length)){this._state.widths=[];const r={noPaging:!0};if(this.dt.options.header||this.dt.options.footer){this.dt.options.scrollY.length&&(r.unhideHeader=!0),this.dt.headerDOM&&this.dt.headerDOM.parentElement.removeChild(this.dt.headerDOM),r.noColumnWidths=!0,this.dt._renderTable(r);const o=Array.from(((s=(t=this.dt.dom.querySelector("thead, tfoot"))==null?void 0:t.firstElementChild)==null?void 0:s.querySelectorAll("th"))||[]);let l=0;const d=this.dt.data.headings.map((f,h)=>{var p;if((p=this.settings[h])!=null&&p.hidden)return 0;const m=o[l].offsetWidth;return l+=1,m}),u=d.reduce((f,h)=>f+h,0);this._state.widths=d.map(f=>f/u*100)}else{r.renderHeader=!0,this.dt._renderTable(r);const o=Array.from(((a=(n=this.dt.dom.querySelector("thead, tfoot"))==null?void 0:n.firstElementChild)==null?void 0:a.querySelectorAll("th"))||[]);let l=0;const d=this.dt.data.headings.map((f,h)=>{var p;if((p=this.settings[h])!=null&&p.hidden)return 0;const m=o[l].offsetWidth;return l+=1,m}),u=d.reduce((f,h)=>f+h,0);this._state.widths=d.map(f=>f/u*100)}this.dt._renderTable()}}}const ut={sortable:!0,locale:"en",numeric:!0,caseFirst:"false",searchable:!0,sensitivity:"base",ignorePunctuation:!0,destroyable:!0,searchItemSeparator:"",searchQuerySeparator:" ",searchAnd:!1,data:{},type:"html",format:"YYYY-MM-DD",columns:[],paging:!0,perPage:10,perPageSelect:[5,10,15,20,25],nextPrev:!0,firstLast:!1,prevText:"",nextText:"",firstText:"",lastText:"",ellipsisText:"",truncatePager:!0,pagerDelta:2,scrollY:"",fixedColumns:!0,fixedHeight:!1,footer:!1,header:!0,hiddenHeader:!1,caption:void 0,rowNavigation:!1,tabIndex:!1,pagerRender:!1,rowRender:!1,tableRender:!1,diffDomOptions:{valueDiffing:!1},labels:{placeholder:"Search...",searchTitle:"Search within table",perPage:"entries per page",pageTitle:"Page {page}",noRows:"No entries found",noResults:"No results match your search query",info:"Showing {start} to {end} of {rows} entries"},template:(i,e)=>`<div class='${i.classes.top}'>
    ${i.paging&&i.perPageSelect?`<div class='${i.classes.dropdown}'>
            <label>
                <select class='${i.classes.selector}' name="per-page"></select> ${i.labels.perPage}
            </label>
        </div>`:""}
    ${i.searchable?`<div class='${i.classes.search}'>
            <input class='${i.classes.input}' placeholder='${i.labels.placeholder}' type='search' name="search" title='${i.labels.searchTitle}'${e.id?` aria-controls="${e.id}"`:""}>
        </div>`:""}
</div>
<div class='${i.classes.container}'${i.scrollY.length?` style='height: ${i.scrollY}; overflow-Y: auto;'`:""}></div>
<div class='${i.classes.bottom}'>
    ${i.paging?`<div class='${i.classes.info}'></div>`:""}
    <nav class='${i.classes.pagination}'></nav>
</div>`,classes:{active:"datatable-active",ascending:"datatable-ascending",bottom:"datatable-bottom",container:"datatable-container",cursor:"datatable-cursor",descending:"datatable-descending",disabled:"datatable-disabled",dropdown:"datatable-dropdown",ellipsis:"datatable-ellipsis",filter:"datatable-filter",filterActive:"datatable-filter-active",empty:"datatable-empty",headercontainer:"datatable-headercontainer",hidden:"datatable-hidden",info:"datatable-info",input:"datatable-input",loading:"datatable-loading",pagination:"datatable-pagination",paginationList:"datatable-pagination-list",paginationListItem:"datatable-pagination-list-item",paginationListItemLink:"datatable-pagination-list-item-link",search:"datatable-search",selector:"datatable-selector",sorter:"datatable-sorter",table:"datatable-table",top:"datatable-top",wrapper:"datatable-wrapper"}},lt=(i,e,t,s={})=>({nodeName:"LI",attributes:{class:s.active&&!s.hidden?`${t.classes.paginationListItem} ${t.classes.active}`:s.hidden?`${t.classes.paginationListItem} ${t.classes.hidden} ${t.classes.disabled}`:t.classes.paginationListItem},childNodes:[{nodeName:"BUTTON",attributes:{"data-page":String(i),class:t.classes.paginationListItemLink,"aria-label":t.labels.pageTitle.replace("{page}",String(i))},childNodes:[{nodeName:"#text",data:e}]}]}),te=(i,e,t,s,n)=>{let a=[];if(n.firstLast&&a.push(lt(1,n.firstText,n)),n.nextPrev){const o=i?1:t-1;a.push(lt(o,n.prevText,n,{hidden:i}))}let r=[...Array(s).keys()].map(o=>lt(o+1,String(o+1),n,{active:o===t-1}));if(n.truncatePager&&(r=((o,l,d,u)=>{const f=u.pagerDelta,h=u.classes,m=u.ellipsisText,p=2*f;let y=l-f,N=l+f;l<4-f+p?N=3+p:l>d-(3-f+p)&&(y=d-(2+p));const E=[];for(let k=1;k<=d;k++)if(k==1||k==d||k>=y&&k<=N){const S=o[k-1];E.push(S)}let c;const w=[];return E.forEach(k=>{const S=parseInt(k.childNodes[0].attributes["data-page"],10);if(c){const C=parseInt(c.childNodes[0].attributes["data-page"],10);if(S-C==2)w.push(o[C]);else if(S-C!=1){const L={nodeName:"LI",attributes:{class:`${h.paginationListItem} ${h.ellipsis} ${h.disabled}`},childNodes:[{nodeName:"BUTTON",attributes:{class:h.paginationListItemLink},childNodes:[{nodeName:"#text",data:m}]}]};w.push(L)}}w.push(k),c=k}),w})(r,t,s,n)),a=a.concat(r),n.nextPrev){const o=e?s:t+1;a.push(lt(o,n.nextText,n,{hidden:e}))}return n.firstLast&&a.push(lt(s,n.lastText,n)),{nodeName:"UL",attributes:{class:n.classes.paginationList},childNodes:r.length>1?a:[]}};class re{constructor(e,t={}){M(this,"columns");M(this,"containerDOM");M(this,"_currentPage");M(this,"data");M(this,"_dd");M(this,"dom");M(this,"_events");M(this,"hasHeadings");M(this,"hasRows");M(this,"headerDOM");M(this,"_initialHTML");M(this,"initialized");M(this,"_label");M(this,"lastPage");M(this,"_listeners");M(this,"onFirstPage");M(this,"onLastPage");M(this,"options");M(this,"_pagerDOMs");M(this,"_virtualPagerDOM");M(this,"pages");M(this,"_rect");M(this,"rows");M(this,"_searchData");M(this,"_searchQueries");M(this,"_tableAttributes");M(this,"_tableFooters");M(this,"_tableCaptions");M(this,"totalPages");M(this,"_virtualDOM");M(this,"_virtualHeaderDOM");M(this,"wrapperDOM");const s=typeof e=="string"?document.querySelector(e):e;s instanceof HTMLTableElement?this.dom=s:(this.dom=document.createElement("table"),s.appendChild(this.dom));const n={...ut.diffDomOptions,...t.diffDomOptions},a={...ut.labels,...t.labels},r={...ut.classes,...t.classes};this.options={...ut,...t,diffDomOptions:n,labels:a,classes:r},this._initialHTML=this.options.destroyable?s.outerHTML:"",this.options.tabIndex?this.dom.tabIndex=this.options.tabIndex:this.options.rowNavigation&&this.dom.tabIndex===-1&&(this.dom.tabIndex=0),this._listeners={onResize:()=>this._onResize()},this._dd=new Xt(this.options.diffDomOptions||{}),this.initialized=!1,this._events={},this._currentPage=0,this.onFirstPage=!0,this.hasHeadings=!1,this.hasRows=!1,this._searchQueries=[],this.init()}init(){var e,t;if(this.initialized||wt(this.dom,this.options.classes.table))return!1;this._virtualDOM=nt(this.dom,this.options.diffDomOptions||{}),this._tableAttributes={...this._virtualDOM.attributes},this._tableFooters=((e=this._virtualDOM.childNodes)==null?void 0:e.filter(s=>s.nodeName==="TFOOT"))??[],this._tableCaptions=((t=this._virtualDOM.childNodes)==null?void 0:t.filter(s=>s.nodeName==="CAPTION"))??[],this.options.caption!==void 0&&this._tableCaptions.push({nodeName:"CAPTION",childNodes:[{nodeName:"#text",data:this.options.caption}]}),this.rows=new Gt(this),this.columns=new Kt(this),this.data=At(this.options.data,this.dom,this.columns.settings,this.options.type,this.options.format),this._render(),setTimeout(()=>{this.emit("datatable.init"),this.initialized=!0},10)}_render(){this.wrapperDOM=U("div",{class:`${this.options.classes.wrapper} ${this.options.classes.loading}`}),this.wrapperDOM.innerHTML=this.options.template(this.options,this.dom);const e=B(this.options.classes.selector),t=this.wrapperDOM.querySelector(`select${e}`);t&&this.options.paging&&this.options.perPageSelect?this.options.perPageSelect.forEach(r=>{const[o,l]=Array.isArray(r)?[r[0],r[1]]:[String(r),r],d=l===this.options.perPage,u=new Option(o,String(l),d,d);t.appendChild(u)}):t&&t.parentElement.removeChild(t);const s=B(this.options.classes.container);this.containerDOM=this.wrapperDOM.querySelector(s),this._pagerDOMs=[];const n=B(this.options.classes.pagination);Array.from(this.wrapperDOM.querySelectorAll(n)).forEach(r=>{r instanceof HTMLElement&&(r.innerHTML=`<ul class="${this.options.classes.paginationList}"></ul>`,this._pagerDOMs.push(r.firstElementChild))}),this._virtualPagerDOM={nodeName:"UL",attributes:{class:this.options.classes.paginationList}};const a=B(this.options.classes.info);this._label=this.wrapperDOM.querySelector(a),this.dom.parentElement.replaceChild(this.wrapperDOM,this.dom),this.containerDOM.appendChild(this.dom),this._rect=this.dom.getBoundingClientRect(),this._fixHeight(),this.options.header||this.wrapperDOM.classList.add("no-header"),this.options.footer||this.wrapperDOM.classList.add("no-footer"),this.options.sortable&&this.wrapperDOM.classList.add("sortable"),this.options.searchable&&this.wrapperDOM.classList.add("searchable"),this.options.fixedHeight&&this.wrapperDOM.classList.add("fixed-height"),this.options.fixedColumns&&this.wrapperDOM.classList.add("fixed-columns"),this._bindEvents(),this.columns._state.sort&&this.columns.sort(this.columns._state.sort.column,this.columns._state.sort.dir,!0),this.update(!0)}_renderTable(e={}){let t;t=(this.options.paging||this._searchQueries.length||this.columns._state.filters.length)&&this._currentPage&&this.pages.length&&!e.noPaging?this.pages[this._currentPage-1]:this.data.data.map((a,r)=>({row:a,index:r}));let s=Tt(this._tableAttributes,this.data.headings,t,this.columns.settings,this.columns._state,this.rows.cursor,this.options,e,this._tableFooters,this._tableCaptions);if(this.options.tableRender){const a=this.options.tableRender(this.data,s,"main");a&&(s=a)}const n=this._dd.diff(this._virtualDOM,s);this._dd.apply(this.dom,n),this._virtualDOM=s}_renderPage(e=!1){this.hasRows&&this.totalPages?(this._currentPage>this.totalPages&&(this._currentPage=1),this._renderTable(),this.onFirstPage=this._currentPage===1,this.onLastPage=this._currentPage===this.lastPage):this.setMessage(this.options.labels.noRows);let t,s=0,n=0,a=0;if(this.totalPages&&(s=this._currentPage-1,n=s*this.options.perPage,a=n+this.pages[s].length,n+=1,t=this._searchQueries.length?this._searchData.length:this.data.data.length),this._label&&this.options.labels.info.length){const r=this.options.labels.info.replace("{start}",String(n)).replace("{end}",String(a)).replace("{page}",String(this._currentPage)).replace("{pages}",String(this.totalPages)).replace("{rows}",String(t));this._label.innerHTML=t?r:""}if(this._currentPage==1&&this._fixHeight(),this.options.rowNavigation&&this._currentPage&&(!this.rows.cursor||!this.pages[this._currentPage-1].find(r=>r.index===this.rows.cursor))){const r=this.pages[this._currentPage-1];r.length&&(e?this.rows.setCursor(r[r.length-1].index):this.rows.setCursor(r[0].index))}}_renderPagers(){if(!this.options.paging)return;let e=te(this.onFirstPage,this.onLastPage,this._currentPage,this.totalPages,this.options);if(this.options.pagerRender){const s=this.options.pagerRender([this.onFirstPage,this.onLastPage,this._currentPage,this.totalPages],e);s&&(e=s)}const t=this._dd.diff(this._virtualPagerDOM,e);this._pagerDOMs.forEach(s=>{this._dd.apply(s,t)}),this._virtualPagerDOM=e}_renderSeparateHeader(){const e=this.dom.parentElement;this.headerDOM||(this.headerDOM=document.createElement("div"),this._virtualHeaderDOM={nodeName:"DIV"}),e.parentElement.insertBefore(this.headerDOM,e);let t={nodeName:"TABLE",attributes:this._tableAttributes,childNodes:[{nodeName:"THEAD",childNodes:[Et(this.data.headings,this.columns.settings,this.columns._state,this.options,{unhideHeader:!0})]}]};if(t.attributes.class=X(t.attributes.class,this.options.classes.table),this.options.tableRender){const r=this.options.tableRender(this.data,t,"header");r&&(t=r)}const s={nodeName:"DIV",attributes:{class:this.options.classes.headercontainer},childNodes:[t]},n=this._dd.diff(this._virtualHeaderDOM,s);this._dd.apply(this.headerDOM,n),this._virtualHeaderDOM=s;const a=this.headerDOM.firstElementChild.clientWidth-this.dom.clientWidth;if(a){const r=structuredClone(this._virtualHeaderDOM);r.attributes.style=`padding-right: ${a}px;`;const o=this._dd.diff(this._virtualHeaderDOM,r);this._dd.apply(this.headerDOM,o),this._virtualHeaderDOM=r}e.scrollHeight>e.clientHeight&&(e.style.overflowY="scroll")}_bindEvents(){if(this.options.perPageSelect){const e=B(this.options.classes.selector),t=this.wrapperDOM.querySelector(e);t&&t instanceof HTMLSelectElement&&t.addEventListener("change",()=>{this.options.perPage=parseInt(t.value,10),this.update(),this._fixHeight(),this.emit("datatable.perpage",this.options.perPage)},!1)}this.options.searchable&&this.wrapperDOM.addEventListener("input",e=>{const t=B(this.options.classes.input),s=e.target;if(!(s instanceof HTMLInputElement&&s.matches(t)))return;e.preventDefault();const n=[];if(Array.from(this.wrapperDOM.querySelectorAll(t)).filter(a=>a.value.length).forEach(a=>{const r=a.dataset.and||this.options.searchAnd,o=a.dataset.querySeparator||this.options.searchQuerySeparator?a.value.split(this.options.searchQuerySeparator):[a.value];r?o.forEach(l=>{a.dataset.columns?n.push({terms:[l],columns:JSON.parse(a.dataset.columns)}):n.push({terms:[l],columns:void 0})}):a.dataset.columns?n.push({terms:o,columns:JSON.parse(a.dataset.columns)}):n.push({terms:o,columns:void 0})}),n.length===1&&n[0].terms.length===1){const a=n[0];this.search(a.terms[0],a.columns)}else this.multiSearch(n)}),this.wrapperDOM.addEventListener("click",e=>{const t=e.target.closest("a, button");if(t){if(t.hasAttribute("data-page"))this.page(parseInt(t.getAttribute("data-page"),10)),e.preventDefault();else if(wt(t,this.options.classes.sorter)){const s=Array.from(t.parentElement.parentElement.children).indexOf(t.parentElement),n=pt(s,this.columns.settings);this.columns.sort(n),e.preventDefault()}else if(wt(t,this.options.classes.filter)){const s=Array.from(t.parentElement.parentElement.children).indexOf(t.parentElement),n=pt(s,this.columns.settings);this.columns.filter(n),e.preventDefault()}}},!1),this.options.rowNavigation?(this.dom.addEventListener("keydown",e=>{if(e.key==="ArrowUp"){let t;e.preventDefault(),e.stopPropagation(),this.pages[this._currentPage-1].find(s=>s.index===this.rows.cursor||(t=s,!1)),t?this.rows.setCursor(t.index):this.onFirstPage||this.page(this._currentPage-1,!0)}else if(e.key==="ArrowDown"){let t;e.preventDefault(),e.stopPropagation();const s=this.pages[this._currentPage-1].find(n=>!!t||(n.index===this.rows.cursor&&(t=!0),!1));s?this.rows.setCursor(s.index):this.onLastPage||this.page(this._currentPage+1)}else["Enter"," "].includes(e.key)&&this.emit("datatable.selectrow",this.rows.cursor,e)}),this.dom.addEventListener("mousedown",e=>{const t=e.target;if(t instanceof Element&&this.dom.matches(":focus")){const s=Array.from(this.dom.querySelectorAll("tbody > tr")).find(n=>n.contains(t));s&&s instanceof HTMLElement&&this.emit("datatable.selectrow",parseInt(s.dataset.index,10),e)}})):this.dom.addEventListener("mousedown",e=>{const t=e.target;if(!(t instanceof Element))return;const s=Array.from(this.dom.querySelectorAll("tbody > tr")).find(n=>n.contains(t));s&&s instanceof HTMLElement&&this.emit("datatable.selectrow",parseInt(s.dataset.index,10),e)}),window.addEventListener("resize",this._listeners.onResize)}_onResize(){this._rect=this.containerDOM.getBoundingClientRect(),this._rect.width&&this.update(!0)}destroy(){var e;if(this.options.destroyable){if(this.wrapperDOM.parentElement){const t=U("div");t.innerHTML=this._initialHTML,this.wrapperDOM.parentElement.replaceChild(t.firstElementChild,this.wrapperDOM)}else(e=this.options.classes.table)==null||e.split(" ").forEach(t=>this.wrapperDOM.classList.remove(t));window.removeEventListener("resize",this._listeners.onResize),this.initialized=!1}}update(e=!1){var t;e&&(this.columns._measureWidths(),this.hasRows=!!this.data.data.length,this.hasHeadings=!!this.data.headings.length),(t=this.options.classes.empty)==null||t.split(" ").forEach(s=>this.wrapperDOM.classList.remove(s)),this._paginate(),this._renderPage(),this._renderPagers(),this.options.scrollY.length&&this._renderSeparateHeader(),this.emit("datatable.update")}_paginate(){let e=this.data.data.map((t,s)=>({row:t,index:s}));return this._searchQueries.length&&(e=[],this._searchData.forEach(t=>e.push({index:t,row:this.data.data[t]}))),this.columns._state.filters.length&&this.columns._state.filters.forEach((t,s)=>{t&&(e=e.filter(n=>{const a=n.row.cells[s];return typeof t=="function"?t(a.data):z(a)===t}))}),this.options.paging&&this.options.perPage>0?this.pages=e.map((t,s)=>s%this.options.perPage==0?e.slice(s,s+this.options.perPage):null).filter(t=>t):this.pages=[e],this.totalPages=this.lastPage=this.pages.length,this._currentPage||(this._currentPage=1),this.totalPages}_fixHeight(){this.options.fixedHeight&&(this.containerDOM.style.height=null,this._rect=this.containerDOM.getBoundingClientRect(),this.containerDOM.style.height=`${this._rect.height}px`)}search(e,t=void 0){if(!e.length)return this._currentPage=1,this._searchQueries=[],this._searchData=[],this.update(),this.emit("datatable.search","",[]),this.wrapperDOM.classList.remove("search-results"),!1;this.multiSearch([{terms:[e],columns:t||void 0}]),this.emit("datatable.search",e,this._searchData)}multiSearch(e){if(!this.hasRows)return!1;this._currentPage=1,this._searchData=[];const t=e.map(n=>({columns:n.columns,terms:n.terms.map(a=>a.trim()).filter(a=>a)})).filter(n=>n.terms.length);if(this._searchQueries=t,!t.length)return this.update(),this.emit("datatable.multisearch",t,this._searchData),this.wrapperDOM.classList.remove("search-results"),!1;const s=t.map(n=>this.columns.settings.map((a,r)=>{if(a.hidden||!a.searchable||n.columns&&!n.columns.includes(r))return!1;let o=n.terms;const l=a.sensitivity||this.options.sensitivity;return["base","accent"].includes(l)&&(o=o.map(d=>d.toLowerCase())),["base","case"].includes(l)&&(o=o.map(d=>d.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),""))),(a.ignorePunctuation??this.options.ignorePunctuation)&&(o=o.map(d=>d.replace(/[.,/#!$%^&*;:{}=-_`~()]/g,""))),o}));this.data.data.forEach((n,a)=>{const r=n.cells.map((o,l)=>{let d=z(o).trim();const u=this.columns.settings[l];if(d.length){const h=u.sensitivity||this.options.sensitivity;["base","accent"].includes(h)&&(d=d.toLowerCase()),["base","case"].includes(h)&&(d=d.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")),(u.ignorePunctuation??this.options.ignorePunctuation)&&(d=d.replace(/[.,/#!$%^&*;:{}=-_`~()]/g,""))}const f=u.searchItemSeparator||this.options.searchItemSeparator;return f?d.split(f):[d]});s.every(o=>o.find((l,d)=>!!l&&l.find(u=>r[d].find(f=>f.includes(u)))))&&this._searchData.push(a)}),this.wrapperDOM.classList.add("search-results"),this._searchData.length?this.update():(this.wrapperDOM.classList.remove("search-results"),this.setMessage(this.options.labels.noResults)),this.emit("datatable.multisearch",t,this._searchData)}page(e,t=!1){return e!==this._currentPage&&(isNaN(e)||(this._currentPage=e),!(e>this.pages.length||e<0)&&(this._renderPage(t),this._renderPagers(),void this.emit("datatable.page",e)))}insert(e){let t=[];if(Array.isArray(e)){const s=this.data.headings.map(n=>n.data?String(n.data):n.text);e.forEach((n,a)=>{const r=[];Object.entries(n).forEach(([o,l])=>{const d=s.indexOf(o);d>-1?r[d]=ot(l,this.columns.settings[d]):this.hasHeadings||this.hasRows||a!==0||(r[s.length]=ot(l,this.columns.settings[s.length]),s.push(o),this.data.headings.push(ct(o)))}),t.push({cells:r})})}else et(e)&&(!e.headings||this.hasHeadings||this.hasRows?e.data&&Array.isArray(e.data)&&(t=e.data.map(s=>{let n,a;return Array.isArray(s)?(n={},a=s):(n=s.attributes,a=s.cells),{attributes:n,cells:a.map((r,o)=>ot(r,this.columns.settings[o]))}})):this.data=At(e,void 0,this.columns.settings,this.options.type,this.options.format));t.length&&t.forEach(s=>this.data.data.push(s)),this.hasHeadings=!!this.data.headings.length,this.columns._state.sort&&this.columns.sort(this.columns._state.sort.column,this.columns._state.sort.dir,!0),this.update(!0)}refresh(){if(this.options.searchable){const e=B(this.options.classes.input);Array.from(this.wrapperDOM.querySelectorAll(e)).forEach(t=>t.value=""),this._searchQueries=[]}this._currentPage=1,this.onFirstPage=!0,this.update(!0),this.emit("datatable.refresh")}print(){const e=U("table");let t=Tt(this._tableAttributes,this.data.headings,this.data.data.map((a,r)=>({row:a,index:r})),this.columns.settings,this.columns._state,!1,this.options,{noColumnWidths:!0,unhideHeader:!0},this._tableFooters,this._tableCaptions);if(this.options.tableRender){const a=this.options.tableRender(this.data,t,"print");a&&(t=a)}const s=this._dd.diff({nodeName:"TABLE"},t);this._dd.apply(e,s);const n=window.open();n.document.body.appendChild(e),n.print()}setMessage(e){var a;const t=this.data.headings.filter((r,o)=>{var l;return!((l=this.columns.settings[o])!=null&&l.hidden)}).length||1;(a=this.options.classes.empty)==null||a.split(" ").forEach(r=>this.wrapperDOM.classList.add(r)),this._label&&(this._label.innerHTML=""),this.totalPages=0,this._renderPagers();let s={nodeName:"TABLE",attributes:this._tableAttributes,childNodes:[{nodeName:"THEAD",childNodes:[Et(this.data.headings,this.columns.settings,this.columns._state,this.options,{})]},{nodeName:"TBODY",childNodes:[{nodeName:"TR",childNodes:[{nodeName:"TD",attributes:{class:this.options.classes.empty,colspan:String(t)},childNodes:[{nodeName:"#text",data:e}]}]}]}]};if(this._tableFooters.forEach(r=>s.childNodes.push(r)),this._tableCaptions.forEach(r=>s.childNodes.push(r)),s.attributes.class=X(s.attributes.class,this.options.classes.table),this.options.tableRender){const r=this.options.tableRender(this.data,s,"message");r&&(s=r)}const n=this._dd.diff(this._virtualDOM,s);this._dd.apply(this.dom,n),this._virtualDOM=s}on(e,t){this._events[e]=this._events[e]||[],this._events[e].push(t)}off(e,t){e in this._events&&this._events[e].splice(this._events[e].indexOf(t),1)}emit(e,...t){if(e in this._events)for(let s=0;s<this._events[e].length;s++)this._events[e][s](...t)}}const le=function(i){let e;if(!et(i))return!1;const t={lineDelimiter:`
`,columnDelimiter:",",removeDoubleQuotes:!1,...i};if(t.data.length){e={data:[]};const s=t.data.split(t.lineDelimiter);if(s.length&&(t.headings&&(e.headings=s[0].split(t.columnDelimiter),t.removeDoubleQuotes&&(e.headings=e.headings.map(n=>n.trim().replace(/(^"|"$)/g,""))),s.shift()),s.forEach((n,a)=>{e.data[a]=[];const r=n.split(t.columnDelimiter);r.length&&r.forEach(o=>{t.removeDoubleQuotes&&(o=o.trim().replace(/(^"|"$)/g,"")),e.data[a].push(o)})})),e)return e}return!1},de=function(i){let e;if(!et(i))return!1;const t={data:"",...i};if(t.data.length||et(t.data)){const s=!!Yt(t.data)&&JSON.parse(t.data);if(s?(e={headings:[],data:[]},s.forEach((n,a)=>{e.data[a]=[],Object.entries(n).forEach(([r,o])=>{e.headings.includes(r)||e.headings.push(r),e.data[a].push(o)})})):console.warn("That's not valid JSON!"),e)return e}return!1},ce=function(i,e={}){if(!i.hasHeadings&&!i.hasRows||!et(e))return!1;const t={download:!0,skipColumn:[],lineDelimiter:`
`,columnDelimiter:",",...e},s=o=>{var l;return!t.skipColumn.includes(o)&&!((l=i.columns.settings[o])!=null&&l.hidden)},n=i.data.headings.filter((o,l)=>s(l)).map(o=>o.text??o.data);let a;if(t.selection)if(Array.isArray(t.selection)){a=[];for(let o=0;o<t.selection.length;o++)a=a.concat(i.pages[t.selection[o]-1].map(l=>l.row))}else a=i.pages[t.selection-1].map(o=>o.row);else a=i.data.data;let r=[];if(r[0]=n,r=r.concat(a.map(o=>o.cells.filter((l,d)=>s(d)).map(l=>z(l)))),r.length){let o="";if(r.forEach(l=>{l.forEach(d=>{typeof d=="string"&&(d=(d=(d=(d=(d=d.trim()).replace(/\s{2,}/g," ")).replace(/\n/g,"  ")).replace(/"/g,'""')).replace(/#/g,"%23")).includes(",")&&(d=`"${d}"`),o+=d+t.columnDelimiter}),o=o.trim().substring(0,o.length-1),o+=t.lineDelimiter}),o=o.trim().substring(0,o.length-1),t.download){const l=document.createElement("a");l.href=encodeURI(`data:text/csv;charset=utf-8,${o}`),l.download=`${t.filename||"datatable_export"}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l)}return o}return!1},he=function(i,e={}){if(!i.hasHeadings&&!i.hasRows||!et(e))return!1;const t={download:!0,skipColumn:[],replacer:null,space:4,...e},s=o=>{var l;return!t.skipColumn.includes(o)&&!((l=i.columns.settings[o])!=null&&l.hidden)};let n;if(t.selection)if(Array.isArray(t.selection)){n=[];for(let o=0;o<t.selection.length;o++)n=n.concat(i.pages[t.selection[o]-1].map(l=>l.row))}else n=i.pages[t.selection-1].map(o=>o.row);else n=i.data.data;const a=n.map(o=>o.cells.filter((l,d)=>s(d)).map(l=>z(l))),r=i.data.headings.filter((o,l)=>s(l)).map(o=>o.text??String(o.data));if(a.length){const o=[];a.forEach((d,u)=>{o[u]=o[u]||{},d.forEach((f,h)=>{o[u][r[h]]=f})});const l=JSON.stringify(o,t.replacer,t.space);if(t.download){const d=new Blob([l],{type:"data:application/json;charset=utf-8"}),u=URL.createObjectURL(d),f=document.createElement("a");f.href=u,f.download=`${t.filename||"datatable_export"}.json`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(u)}return l}return!1},ue=function(i,e={}){if(!i.hasHeadings&&!i.hasRows||!et(e))return!1;const t={download:!0,skipColumn:[],tableName:"myTable",...e},s=o=>{var l;return!t.skipColumn.includes(o)&&!((l=i.columns.settings[o])!=null&&l.hidden)};let n=[];if(t.selection)if(Array.isArray(t.selection))for(let o=0;o<t.selection.length;o++)n=n.concat(i.pages[t.selection[o]-1].map(l=>l.row));else n=i.pages[t.selection-1].map(o=>o.row);else n=i.data.data;const a=n.map(o=>o.cells.filter((l,d)=>s(d)).map(l=>z(l))),r=i.data.headings.filter((o,l)=>s(l)).map(o=>o.text??String(o.data));if(a.length){let o=`INSERT INTO \`${t.tableName}\` (`;if(r.forEach(l=>{o+=`\`${l}\`,`}),o=o.trim().substring(0,o.length-1),o+=") VALUES ",a.forEach(l=>{o+="(",l.forEach(d=>{o+=typeof d=="string"?`"${d}",`:`${d},`}),o=o.trim().substring(0,o.length-1),o+="),"}),o=o.trim().substring(0,o.length-1),o+=";",t.download&&(o=`data:application/sql;charset=utf-8,${o}`),t.download){const l=document.createElement("a");l.href=encodeURI(o),l.download=`${t.filename||"datatable_export"}.sql`,document.body.appendChild(l),l.click(),document.body.removeChild(l)}return o}return!1},pe=function(i,e={}){if(!i.hasHeadings&&!i.hasRows||!et(e))return!1;const t={download:!0,skipColumn:[],lineDelimiter:`
`,columnDelimiter:",",...e},s=o=>{var l;return!t.skipColumn.includes(o)&&!((l=i.columns.settings[o])!=null&&l.hidden)},n=i.data.headings.filter((o,l)=>s(l)).map(o=>o.text??o.data);let a;if(t.selection)if(Array.isArray(t.selection)){a=[];for(let o=0;o<t.selection.length;o++)a=a.concat(i.pages[t.selection[o]-1].map(l=>l.row))}else a=i.pages[t.selection-1].map(o=>o.row);else a=i.data.data;let r=[];if(r[0]=n,r=r.concat(a.map(o=>o.cells.filter((l,d)=>s(d)).map(l=>z(l)))),r.length){let o="";if(r.forEach(l=>{l.forEach(d=>{typeof d=="string"&&(d=(d=(d=(d=(d=d.trim()).replace(/\s{2,}/g," ")).replace(/\n/g,"  ")).replace(/"/g,'""')).replace(/#/g,"%23")).includes(",")&&(d=`"${d}"`),o+=d+t.columnDelimiter}),o=o.trim().substring(0,o.length-1),o+=t.lineDelimiter}),o=o.trim().substring(0,o.length-1),t.download&&(o=`data:text/csv;charset=utf-8,${o}`),t.download){const l=document.createElement("a");l.href=encodeURI(o),l.download=`${t.filename||"datatable_export"}.txt`,document.body.appendChild(l),l.click(),document.body.removeChild(l)}return o}return!1},ee={classes:{row:"datatable-editor-row",form:"datatable-editor-form",item:"datatable-editor-item",menu:"datatable-editor-menu",save:"datatable-editor-save",block:"datatable-editor-block",cancel:"datatable-editor-cancel",close:"datatable-editor-close",inner:"datatable-editor-inner",input:"datatable-editor-input",label:"datatable-editor-label",modal:"datatable-editor-modal",action:"datatable-editor-action",header:"datatable-editor-header",wrapper:"datatable-editor-wrapper",editable:"datatable-editor-editable",container:"datatable-editor-container",separator:"datatable-editor-separator"},labels:{closeX:"x",editCell:"Edit Cell",editRow:"Edit Row",removeRow:"Remove Row",reallyRemove:"Are you sure?",reallyCancel:"Do you really want to cancel?",save:"Save",cancel:"Cancel"},cancelModal:i=>confirm(i.options.labels.reallyCancel),inline:!0,hiddenColumns:!1,contextMenu:!0,clickEvent:"dblclick",excludeColumns:[],menuItems:[{text:i=>i.options.labels.editCell,action:(i,e)=>{if(!(i.event.target instanceof Element))return;const t=i.event.target.closest("td");return i.editCell(t)}},{text:i=>i.options.labels.editRow,action:(i,e)=>{if(!(i.event.target instanceof Element))return;const t=i.event.target.closest("tr");return i.editRow(t)}},{separator:!0},{text:i=>i.options.labels.removeRow,action:(i,e)=>{if(i.event.target instanceof Element&&confirm(i.options.labels.reallyRemove)){const t=i.event.target.closest("tr");i.removeRow(t)}}}]};class se{constructor(e,t={}){M(this,"menuOpen");M(this,"containerDOM");M(this,"data");M(this,"disabled");M(this,"dt");M(this,"editing");M(this,"editingCell");M(this,"editingRow");M(this,"event");M(this,"events");M(this,"initialized");M(this,"limits");M(this,"menuDOM");M(this,"modalDOM");M(this,"options");M(this,"originalRowRender");M(this,"rect");M(this,"wrapperDOM");this.dt=e,this.options={...ee,...t}}init(){var e;this.initialized||((e=this.options.classes.editable)==null||e.split(" ").forEach(t=>this.dt.wrapperDOM.classList.add(t)),this.options.inline&&(this.originalRowRender=this.dt.options.rowRender,this.dt.options.rowRender=(t,s,n)=>{let a=this.rowRender(t,s,n);return this.originalRowRender&&(a=this.originalRowRender(t,a,n)),a}),this.options.contextMenu&&(this.containerDOM=U("div",{id:this.options.classes.container}),this.wrapperDOM=U("div",{class:this.options.classes.wrapper}),this.menuDOM=U("ul",{class:this.options.classes.menu}),this.options.menuItems&&this.options.menuItems.length&&this.options.menuItems.forEach(t=>{const s=U("li",{class:t.separator?this.options.classes.separator:this.options.classes.item});if(!t.separator){const n=U("a",{class:this.options.classes.action,href:t.url||"#",html:typeof t.text=="function"?t.text(this):t.text});s.appendChild(n),t.action&&typeof t.action=="function"&&n.addEventListener("click",a=>{a.preventDefault(),t.action(this,a)})}this.menuDOM.appendChild(s)}),this.wrapperDOM.appendChild(this.menuDOM),this.containerDOM.appendChild(this.wrapperDOM),this.updateMenu()),this.data={},this.menuOpen=!1,this.editing=!1,this.editingRow=!1,this.editingCell=!1,this.bindEvents(),setTimeout(()=>{this.initialized=!0,this.dt.emit("editable.init")},10))}bindEvents(){this.events={keydown:this.keydown.bind(this),click:this.click.bind(this)},this.dt.dom.addEventListener(this.options.clickEvent,this.events.click),document.addEventListener("keydown",this.events.keydown),this.options.contextMenu&&(this.events.context=this.context.bind(this),this.events.updateMenu=this.updateMenu.bind(this),this.events.dismissMenu=this.dismissMenu.bind(this),this.events.reset=function(e,t=300){let s;return(...n)=>{clearTimeout(s),s=window.setTimeout(()=>e(),t)}}(()=>this.events.updateMenu(),50),this.dt.dom.addEventListener("contextmenu",this.events.context),document.addEventListener("click",this.events.dismissMenu),window.addEventListener("resize",this.events.reset),window.addEventListener("scroll",this.events.reset))}context(e){const t=e.target;if(!(t instanceof Element))return;this.event=e;const s=t.closest("tbody td");if(!this.disabled&&s){e.preventDefault();let n=e.pageX,a=e.pageY;n>this.limits.x&&(n-=this.rect.width),a>this.limits.y&&(a-=this.rect.height),this.wrapperDOM.style.top=`${a}px`,this.wrapperDOM.style.left=`${n}px`,this.openMenu(),this.updateMenu()}}click(e){const t=e.target;if(t instanceof Element){if(this.editing&&this.data&&this.editingCell){const s=B(this.options.classes.input),n=this.modalDOM?this.modalDOM.querySelector(`input${s}[type=text]`):this.dt.wrapperDOM.querySelector(`input${s}[type=text]`);this.saveCell(n.value)}else if(!this.editing){const s=t.closest("tbody td");s&&(this.editCell(s),e.preventDefault())}}}keydown(e){const t=B(this.options.classes.input);if(this.modalDOM){if(e.key==="Escape")this.options.cancelModal(this)&&this.closeModal();else if(e.key==="Enter")if(this.editingCell){const s=this.modalDOM.querySelector(`input${t}[type=text]`);this.saveCell(s.value)}else{const s=Array.from(this.modalDOM.querySelectorAll(`input${t}[type=text]`)).map(n=>n.value.trim());this.saveRow(s,this.data.row)}}else if(this.editing&&this.data)if(e.key==="Enter"){if(this.editingCell){const s=this.dt.wrapperDOM.querySelector(`input${t}[type=text]`);this.saveCell(s.value)}else if(this.editingRow){const s=Array.from(this.dt.wrapperDOM.querySelectorAll(`input${t}[type=text]`)).map(n=>n.value.trim());this.saveRow(s,this.data.row)}}else e.key==="Escape"&&(this.editingCell?this.saveCell(this.data.content):this.editingRow&&this.saveRow(null,this.data.row))}editCell(e){const t=pt(e.cellIndex,this.dt.columns.settings);if(this.options.excludeColumns.includes(t))return void this.closeMenu();const s=parseInt(e.parentElement.dataset.index,10),n=this.dt.data.data[s].cells[t];this.data={cell:n,rowIndex:s,columnIndex:t,content:z(n)},this.editing=!0,this.editingCell=!0,this.options.inline?this.dt.update():this.editCellModal(),this.closeMenu()}editCellModal(){const e=this.data.cell,t=this.data.columnIndex,s=this.dt.data.headings[t].text||String(this.dt.data.headings[t].data),n=[`<div class='${this.options.classes.inner}'>`,`<div class='${this.options.classes.header}'>`,`<h4>${this.options.labels.editCell}</h4>`,`<button class='${this.options.classes.close}' type='button' data-editor-cancel>${this.options.labels.closeX}</button>`," </div>",`<div class='${this.options.classes.block}'>`,`<form class='${this.options.classes.form}'>`,`<div class='${this.options.classes.row}'>`,`<label class='${this.options.classes.label}'>${rt(s)}</label>`,`<input class='${this.options.classes.input}' value='${rt(z(e))}' type='text'>`,"</div>",`<div class='${this.options.classes.row}'>`,`<button class='${this.options.classes.cancel}' type='button' data-editor-cancel>${this.options.labels.cancel}</button>`,`<button class='${this.options.classes.save}' type='button' data-editor-save>${this.options.labels.save}</button>`,"</div>","</form>","</div>","</div>"].join(""),a=U("div",{class:this.options.classes.modal,html:n});this.modalDOM=a,this.openModal();const r=B(this.options.classes.input),o=a.querySelector(`input${r}[type=text]`);o.focus(),o.selectionStart=o.selectionEnd=o.value.length,a.addEventListener("click",l=>{const d=l.target;d instanceof Element&&(d.hasAttribute("data-editor-cancel")?(l.preventDefault(),this.options.cancelModal(this)&&this.closeModal()):d.hasAttribute("data-editor-save")&&(l.preventDefault(),this.saveCell(o.value)))})}saveCell(e){const t=this.data.content,s=this.dt.columns.settings[this.data.columnIndex].type||this.dt.options.type,n=e.trim();let a;if(s==="number")a={data:parseFloat(n)};else if(s==="boolean")a=["","false","0"].includes(n)?{data:!1,text:"false",order:0}:{data:!0,text:"true",order:1};else if(s==="html")a={data:[{nodeName:"#text",data:e}],text:e,order:e};else if(s==="string")a={data:e};else if(s==="date"){const l=this.dt.columns.settings[this.data.columnIndex].format||this.dt.options.format;a={data:e,order:gt(String(e),l)}}else a={data:e};this.dt.data.data[this.data.rowIndex].cells[this.data.columnIndex]=a,this.closeModal();const r=this.data.rowIndex,o=this.data.columnIndex;this.data={},this.dt.update(!0),this.editing=!1,this.editingCell=!1,this.dt.emit("editable.save.cell",e,t,r,o)}editRow(e){if(!e||e.nodeName!=="TR"||this.editing)return;const t=parseInt(e.dataset.index,10),s=this.dt.data.data[t];this.data={row:s.cells,rowIndex:t},this.editing=!0,this.editingRow=!0,this.options.inline?this.dt.update():this.editRowModal(),this.closeMenu()}editRowModal(){var l;const e=this.data.row,t=[`<div class='${this.options.classes.inner}'>`,`<div class='${this.options.classes.header}'>`,`<h4>${this.options.labels.editRow}</h4>`,`<button class='${this.options.classes.close}' type='button' data-editor-cancel>${this.options.labels.closeX}</button>`," </div>",`<div class='${this.options.classes.block}'>`,`<form class='${this.options.classes.form}'>`,`<div class='${this.options.classes.row}'>`,`<button class='${this.options.classes.cancel}' type='button' data-editor-cancel>${this.options.labels.cancel}</button>`,`<button class='${this.options.classes.save}' type='button' data-editor-save>${this.options.labels.save}</button>`,"</div>","</form>","</div>","</div>"].join(""),s=U("div",{class:this.options.classes.modal,html:t}),n=s.firstElementChild;if(!n)return;const a=(l=n.lastElementChild)==null?void 0:l.firstElementChild;if(!a)return;e.forEach((d,u)=>{const f=this.dt.columns.settings[u];if((!f.hidden||f.hidden&&this.options.hiddenColumns)&&!this.options.excludeColumns.includes(u)){const h=this.dt.data.headings[u].text||String(this.dt.data.headings[u].data);a.insertBefore(U("div",{class:this.options.classes.row,html:[`<div class='${this.options.classes.row}'>`,`<label class='${this.options.classes.label}'>${rt(h)}</label>`,`<input class='${this.options.classes.input}' value='${rt(z(d))}' type='text'>`,"</div>"].join("")}),a.lastElementChild)}}),this.modalDOM=s,this.openModal();const r=B(this.options.classes.input),o=Array.from(a.querySelectorAll(`input${r}[type=text]`));s.addEventListener("click",d=>{const u=d.target;if(u instanceof Element){if(u.hasAttribute("data-editor-cancel"))this.options.cancelModal(this)&&this.closeModal();else if(u.hasAttribute("data-editor-save")){const f=o.map(h=>h.value.trim());this.saveRow(f,this.data.row)}}})}saveRow(e,t){const s=t.map(r=>z(r)),n=this.dt.data.data[this.data.rowIndex];if(e){let r=0;n.cells=t.map((o,l)=>{if(this.options.excludeColumns.includes(l)||this.dt.columns.settings[l].hidden)return o;const d=this.dt.columns.settings[l].type||this.dt.options.type,u=e[r++];let f;if(d==="number")f={data:parseFloat(u)};else if(d==="boolean")f=["","false","0"].includes(u)?{data:!1,text:"false",order:0}:{data:!0,text:"true",order:1};else if(d==="html")f={data:[{nodeName:"#text",data:u}],text:u,order:u};else if(d==="string")f={data:u};else if(d==="date"){const h=this.dt.columns.settings[l].format||this.dt.options.format;f={data:u,order:gt(String(u),h)}}else f={data:u};return f})}const a=n.cells.map(r=>z(r));this.data={},this.dt.update(!0),this.closeModal(),this.editing=!1,this.dt.emit("editable.save.row",a,s,t)}openModal(){this.modalDOM&&document.body.appendChild(this.modalDOM)}closeModal(){this.editing&&this.modalDOM&&(document.body.removeChild(this.modalDOM),this.modalDOM=this.editing=this.editingRow=this.editingCell=!1)}removeRow(e){if(!e||e.nodeName!=="TR"||this.editing)return;const t=parseInt(e.dataset.index,10);this.dt.rows.remove(t),this.closeMenu()}updateMenu(){const e=window.scrollX||window.pageXOffset,t=window.scrollY||window.pageYOffset;this.rect=this.wrapperDOM.getBoundingClientRect(),this.limits={x:window.innerWidth+e-this.rect.width,y:window.innerHeight+t-this.rect.height}}dismissMenu(e){const t=e.target;if(!(t instanceof Element)||this.wrapperDOM.contains(t))return;let s=!0;if(this.editing){const n=B(this.options.classes.input);s=!t.matches(`input${n}[type=text]`)}s&&this.closeMenu()}openMenu(){if(this.editing&&this.data&&this.editingCell){const e=B(this.options.classes.input),t=this.modalDOM?this.modalDOM.querySelector(`input${e}[type=text]`):this.dt.wrapperDOM.querySelector(`input${e}[type=text]`);this.saveCell(t.value)}document.body.appendChild(this.containerDOM),this.menuOpen=!0,this.dt.emit("editable.context.open")}closeMenu(){this.menuOpen&&(this.menuOpen=!1,document.body.removeChild(this.containerDOM),this.dt.emit("editable.context.close"))}destroy(){this.dt.dom.removeEventListener(this.options.clickEvent,this.events.click),this.dt.dom.removeEventListener("contextmenu",this.events.context),document.removeEventListener("click",this.events.dismissMenu),document.removeEventListener("keydown",this.events.keydown),window.removeEventListener("resize",this.events.reset),window.removeEventListener("scroll",this.events.reset),document.body.contains(this.containerDOM)&&document.body.removeChild(this.containerDOM),this.options.inline&&(this.dt.options.rowRender=this.originalRowRender),this.initialized=!1}rowRender(e,t,s){return!this.data||this.data.rowIndex!==s||(this.editingCell?t.childNodes[function(n,a){let r=n,o=0;for(;o<n;)a[o].hidden&&(r-=1),o++;return r}(this.data.columnIndex,this.dt.columns.settings)].childNodes=[{nodeName:"INPUT",attributes:{type:"text",value:this.data.content,class:this.options.classes.input}}]:t.childNodes.forEach((n,a)=>{const r=pt(a,this.dt.columns.settings),o=e[r];this.options.excludeColumns.includes(r)||(t.childNodes[a].childNodes=[{nodeName:"INPUT",attributes:{type:"text",value:rt(o.text||String(o.data)||""),class:this.options.classes.input}}])})),t}}const me=function(i,e={}){const t=new se(i,e);return i.initialized?t.init():i.on("datatable.init",()=>t.init()),t},ie={classes:{button:"datatable-column-filter-button",menu:"datatable-column-filter-menu",container:"datatable-column-filter-container",wrapper:"datatable-column-filter-wrapper"},labels:{button:"Filter columns within the table"},hiddenColumns:[]};class ne{constructor(e,t={}){M(this,"addedButtonDOM");M(this,"menuOpen");M(this,"buttonDOM");M(this,"dt");M(this,"events");M(this,"initialized");M(this,"options");M(this,"menuDOM");M(this,"containerDOM");M(this,"wrapperDOM");M(this,"limits");M(this,"rect");M(this,"event");this.dt=e,this.options={...ie,...t}}init(){if(this.initialized)return;const e=B(this.options.classes.button);let t=this.dt.wrapperDOM.querySelector(e);if(!t){t=U("button",{class:this.options.classes.button,html:""});const s=B(this.dt.options.classes.search),n=this.dt.wrapperDOM.querySelector(s);n?n.appendChild(t):this.dt.wrapperDOM.appendChild(t),this.addedButtonDOM=!0}this.buttonDOM=t,this.containerDOM=U("div",{id:this.options.classes.container}),this.wrapperDOM=U("div",{class:this.options.classes.wrapper}),this.menuDOM=U("ul",{class:this.options.classes.menu,html:this.dt.data.headings.map((s,n)=>{const a=this.dt.columns.settings[n];return this.options.hiddenColumns.includes(n)?"":`<li data-column="${n}">
                        <input type="checkbox" value="${s.text||s.data}" ${a.hidden?"":"checked=''"}>
                        <label>
                            ${s.text||s.data}
                        </label>
                    </li>`}).join("")}),this.wrapperDOM.appendChild(this.menuDOM),this.containerDOM.appendChild(this.wrapperDOM),this._measureSpace(),this._bind(),this.initialized=!0}dismiss(){this.addedButtonDOM&&this.buttonDOM.parentElement&&this.buttonDOM.parentElement.removeChild(this.buttonDOM),document.removeEventListener("click",this.events.click)}_bind(){this.events={click:this._click.bind(this)},document.addEventListener("click",this.events.click)}_openMenu(){document.body.appendChild(this.containerDOM),this._measureSpace(),this.menuOpen=!0,this.dt.emit("columnFilter.menu.open")}_closeMenu(){this.menuOpen&&(this.menuOpen=!1,document.body.removeChild(this.containerDOM),this.dt.emit("columnFilter.menu.close"))}_measureSpace(){const e=window.scrollX||window.pageXOffset,t=window.scrollY||window.pageYOffset;this.rect=this.wrapperDOM.getBoundingClientRect(),this.limits={x:window.innerWidth+e-this.rect.width,y:window.innerHeight+t-this.rect.height}}_click(e){const t=e.target;if(t instanceof Element)if(this.event=e,this.buttonDOM.contains(t)){if(e.preventDefault(),this.menuOpen)return void this._closeMenu();this._openMenu();let s=e.pageX,n=e.pageY;s>this.limits.x&&(s-=this.rect.width),n>this.limits.y&&(n-=this.rect.height),this.wrapperDOM.style.top=`${n}px`,this.wrapperDOM.style.left=`${s}px`}else if(this.menuDOM.contains(t)){const s=B(this.options.classes.menu),n=t.closest(`${s} > li`);if(!n)return;const a=n.querySelector("input[type=checkbox]");a.contains(t)||(a.checked=!a.checked);const r=Number(n.dataset.column);a.checked?this.dt.columns.show([r]):this.dt.columns.hide([r])}else this.menuOpen&&this._closeMenu()}}const fe=function(i,e={}){const t=new ne(i,e);return i.initialized?t.init():i.on("datatable.init",()=>t.init()),t};export{re as DataTable,fe as addColumnFilter,le as convertCSV,de as convertJSON,U as createElement,ce as exportCSV,he as exportJSON,ue as exportSQL,pe as exportTXT,Yt as isJson,et as isObject,me as makeEditable};
