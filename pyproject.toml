[tool.ruff]
# Exclude upstream assets files from jobserver
exclude = [
  "assets/templates/*",
  "assets/base_views.py"
]

[tool.ruff.lint]
# See: https://docs.astral.sh/ruff/rules/
extend-select = [
  "A", # prevent shadowing builtins
  "COM818", # no trailing commas on bare tuples
  "I",  # isort
  "INP",  # no implicit namespace packages
  "UP",  # pyupgrade
  "W",  # pycodestyle warning
]
extend-ignore = [
  "E501", # ignore line length
]
isort.lines-after-imports = 2

[tool.pytest.ini_options]
DJANGO_SETTINGS_MODULE = "airlock.settings"
testpaths = [
   "tests"
]

[tool.coverage.run]
branch = true
# Required to get full coverage when using Playwright
concurrency = ["greenlet", "thread"]
plugins = ["django_coverage_plugin"]
omit = ["*/assets/*",]

[tool.coverage.report]
fail_under = 100
skip_covered = true
exclude_also = [
    # this indicates that the line should never be hit
    "assert False",
    # this condition is only true when a module is run as a script
    'if __name__ == "__main__":',
    # this indicates that a method should be defined in a subclass
    "raise NotImplementedError",
]

[tool.coverage.django_coverage_plugin]
template_extensions = "html"
exclude_blocks = [
    "\\/\\w+"
]

[tool.ruff.lint.per-file-ignores]
"airlock/views/__init__.py" = ["F401"]

[tool.mypy]
plugins = ["mypy_django_plugin.main"]
disallow_any_generics = true

[tool.django-stubs]
django_settings_module = "airlock.settings"
